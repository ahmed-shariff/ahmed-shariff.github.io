<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@_ahmedshariff_"/><meta name="twitter:creator" content="@_ahmedshariff_"/><meta property="og:url" content="https://shariff-faleel.com/"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_CA"/><meta property="og:site_name" content="Personal website of Shariff Faleel"/><title>Profiling file loading times for org mode</title><meta name="robots" content="index,follow"/><meta name="description" content="Profiling file loading times for org mode"/><meta property="og:title" content="Profiling file loading times for org mode"/><meta property="og:description" content="Profiling file loading times for org mode"/><link rel="canonical" href="https://shariff-faleel.com/post/2022-09-16-profiling_loading_org_files"/><meta name="next-head-count" content="15"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous"/><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script><link rel="preload" href="/_next/static/css/f99a4114f4ea0774.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f99a4114f4ea0774.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-2c3d125ac9294a66.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-1452d81522d66bc9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9dab5dfc0d36cf64.js" defer=""></script><script src="/_next/static/chunks/175675d1-a2f4b19cd9daa73f.js" defer=""></script><script src="/_next/static/chunks/706-5d4770c80855792c.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-8d11634093e6aeae.js" defer=""></script><script src="/_next/static/FFog9YVRqo4UhYbgP_GpH/_buildManifest.js" defer=""></script><script src="/_next/static/FFog9YVRqo4UhYbgP_GpH/_ssgManifest.js" defer=""></script><script src="/_next/static/FFog9YVRqo4UhYbgP_GpH/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="flex flex-col min-h-screen bg-slate-700"><header class="bg-gray-800 mb-0 md:mb-8 py-1 text-gray-300 md:sticky top-0 left-0 right-0 drop-shadow-lg shadow-gray-900 z-10"><div class="container mx-auto flex flex-col md:flex-row gap-x-12 items-center justify-center"><a class="transition duration-100 bg-transparent shadow-md shadow-transparent rounded-lg hover:shadow-gray-900 hover:bg-gray-700 hover:underline hover:decoration-2 px-4 py-2 items-center font-semibold text-lg" href="/">Shariff Faleel</a><a class="transition duration-100 bg-transparent shadow-md shadow-transparent rounded-lg hover:shadow-gray-900 hover:bg-gray-700 hover:underline hover:decoration-2 px-4 py-2 items-center undefined" href="/posts">Posts</a><a class="transition duration-100 bg-transparent shadow-md shadow-transparent rounded-lg hover:shadow-gray-900 hover:bg-gray-700 hover:underline hover:decoration-2 px-4 py-2 items-center undefined" href="/posts?pub=true">Publications</a><a class="transition duration-100 bg-transparent shadow-md shadow-transparent rounded-lg hover:shadow-gray-900 hover:bg-gray-700 hover:underline hover:decoration-2 px-4 py-2 items-center group" href="/"><div>Quick links<!-- --><svg fill="currentColor" viewBox="0 0 20 20" class="inline w-4 h-4 mt-1 ml-1 transition-transform duration-200 transform md:-mt-1 rotate-0 group-hover:rotate-180"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></div><div class="absolute w-full mt-2 origin-top-right rounded-md shadow-lg w-fit transition-transform transition-opacity ease-in-out duration-200 opacity-0 scale-0 group-hover:opacity-100 group-hover:scale-100"><div class="p-2 bg-gray-700 rounded-md shadow dark-mode:bg-gray-700"><div class="block px-4 py-2 rounded-lg hover:bg-gray-600 hover:underline hover:decoration-2 items-center justify-left flex flex-row space-x-2" href="https://gist.github.com/ahmed-shariff"> <!-- --><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></div><div>github-gists</div></div><div class="block px-4 py-2 rounded-lg hover:bg-gray-600 hover:underline hover:decoration-2 items-center justify-left flex flex-row space-x-2" href="/posts.xml"> <!-- --><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M19.199 24C19.199 13.467 10.533 4.8 0 4.8V0c13.165 0 24 10.835 24 24h-4.801zM3.291 17.415c1.814 0 3.293 1.479 3.293 3.295 0 1.813-1.485 3.29-3.301 3.29C1.47 24 0 22.526 0 20.71s1.475-3.294 3.291-3.295zM15.909 24h-4.665c0-6.169-5.075-11.245-11.244-11.245V8.09c8.727 0 15.909 7.184 15.909 15.91z"></path></svg></div><div>RSS feed</div></div></div></div></a></div></header><main class="container mx-auto flex-1"><div class="p-5 md:p-0 prose dark:prose-invert text-justify mx-auto max-w-screen-xl prose-img:block prose-img:m-auto prose-img:max-h-96 prose-p:w-full"><div class="text-xs text-slate-400">September 16, 2022<!-- --><div class="undefined flex gap-x-1 flex-wrap"><a class="text-gray-400" href="/posts?tags=emacs">#emacs</a><a class="text-gray-400" href="/posts?tags=org">#org</a></div></div><h1 class="text-left">Profiling file loading times for org mode<!-- --></h1><div><p>This is an extension of the discussion started in <a href="https://github.com/alphapapa/org-ql/issues/303"><code>org-ql</code>s issues</a>.</p>
<p>Recently I had broken up some of my very large org files that hosted alot of my notes, specially the org file accompanying the bibliography database. It was getting a bit wild to manage a file that had more that 40k lines and performance also was taking a hit.
I loved <code>org-roam</code> using the sqlite back-end to speedup working with a large database of org files, while also giving the end-users access to this back-end.
Before <code>org-roam</code> I was heavily using <code>org-brain</code>. I really liked how the relationships were tucked into property drawers. Since <code>org-roam</code> started track links in the property drawers, I had started completely relying on <code>org-roam</code>.</p>
<p>After breaking apart my large files, all was good and well except for it breaking my <code>org-ql</code> setup.
I was using <code>org-ql</code> alot to quickly query across my database. It's a very cool package that uses the <code>org-agenda</code> buffers to display queries.
While <code>org-roam</code>s <code>org-roam-buffer</code> did some very interesting things, it didn't have the flexibility that <code>org-ql</code> afforded when I wanted to try and search the database based on the links between nodes.
See, <code>org-ql</code> is build on top of the <code>org-element</code> API and <code>org-agenda</code>. They depend on the corresponding org files being open. Whereas <code>org-roam</code> caches all the necessary data in the sqlite database and open the org files only when needed, which is what allows it to be fast when searching through large number of files.
Whereas when trying to run an <code>org-ql</code> query on the same database with a large number of files, it has to open all the files in the database. So I started writing a simple front-end for <code>org-roam</code> with <code>org-ql</code>, where the agenda buffer entries are built from the result of a query to <code>org-roam</code>s database, then <code>org-ql</code> would do it's thing. This way, all files are not being opened. Instead, only the files pertaining the query are being opened, cutting down the number of files that needs to be opened by a very large margin.</p>
<p>While this provides an interface that's usable, the performance was still an issue as it take atleast a few seconds even if the result only had a few dozen nodes. The bottleneck turned out to being opening the files and getting the markers which are needed for <code>org-agenda</code> to work. Following the comments on the <code>org-ql</code> <a href="https://github.com/alphapapa/org-ql/issues/303">issue</a>, I profiled a few different options and see what happens. This post is simply a documentation of this.</p>
<p>All test run on emacs version:</p>
<pre><code class="hljs language-sh">GNU Emacs 28.1 (build 2, x86_64-w64-mingw32) of 2022-04-21
</code></pre>
<h2>Testing the with roam-nodes</h2>
<p>I had three different approaches to opening a file I am testing:</p>
<ul>
<li>The simplest solution using <code>with-current-buffer</code> and <code>find-file-noselect</code>.</li>
<li>Using <code>org-roam-with-file</code></li>
<li>A slightly modified version of <code>org-roam-with-file</code> where <code>org-mode</code> is not loaded. This was for reference more than anything else.</li>
</ul>
<pre><code class="hljs language-lisp">(<span class="hljs-name">defmacro</span> with-plain-file (<span class="hljs-name">file</span> keep-buf-p <span class="hljs-symbol">&amp;rest</span> body)
  <span class="hljs-string">&quot;Same as `org-roam-with-file&#x27;, but doesn&#x27;t start `org-roam&#x27;.&quot;</span>
  (<span class="hljs-name">declare</span> (<span class="hljs-name">indent</span> <span class="hljs-number">2</span>) (<span class="hljs-name">debug</span> <span class="hljs-literal">t</span>))
  `(let* (new-buf
          (auto-mode-alist <span class="hljs-literal">nil</span>)
          (find-file-hook <span class="hljs-literal">nil</span>)
          (buf (or
                (and (not ,file)
                     (current-buffer)) ;If FILE is <span class="hljs-literal">nil</span>, use current buffer
                (find-buffer-visiting ,file) ; If FILE is already visited, find buffer
                (progn
                  (setq new-buf <span class="hljs-literal">t</span>)
                  (find-file-noselect ,file)))) ; Else, visit FILE and return buffer
          res)
     (with-current-buffer buf
       (setq res (progn ,@body))
       (unless (and new-buf (not ,keep-buf-p))
         (save-buffer)))
     (if (and new-buf (not ,keep-buf-p))
         (when (find-buffer-visiting ,file)
           (kill-buffer (find-buffer-visiting ,file))))
     res))
</code></pre>
<p>I started with loading a bunch of random nodes from different files and profile using <code>elp</code> and 55 random nodes (same nodes used on all tests):</p>
<pre><code class="hljs language-lisp">(<span class="hljs-name">defun</span> run-elp (<span class="hljs-name">func</span> sources)
  <span class="hljs-string">&quot;Instrument org and FUNC and iterate on SOURCES with FUNC.
FUNC is a sumbol representing a function that takes one parameter.
SOURCES is a list of element that will be processed by FUNC&quot;</span>
  (<span class="hljs-name">elp-instrument-package</span> <span class="hljs-string">&quot;org&quot;</span>)
  (<span class="hljs-name">elp-instrument-function</span> func)
  (<span class="hljs-name">elp-reset-all</span>)
  (<span class="hljs-name">mapcar</span> func sources)
  (<span class="hljs-name">elp-results</span>))
</code></pre>
<h3>Test with <code>with-current-buffer</code></h3>
<pre><code class="hljs language-lisp">(<span class="hljs-name">defun</span> org-roam-ql--get-file-marker (<span class="hljs-name">node</span>)
  (<span class="hljs-name">with-current-buffer</span> (<span class="hljs-name">find-file-noselect</span> (<span class="hljs-name">org-roam-node-file</span> node))
    (<span class="hljs-name">goto-char</span> (<span class="hljs-name">org-roam-node-point</span> node))
    (<span class="hljs-name">point-marker</span>)))

(<span class="hljs-name">let</span> ((<span class="hljs-name">nodes</span> (<span class="hljs-name">--map</span> (<span class="hljs-name">org-roam-node-from-id</span> it) random-node-ids)))
  (<span class="hljs-name">--map</span> (<span class="hljs-name">when-let</span> (<span class="hljs-name">buf</span> (<span class="hljs-name">find-buffer-visiting</span> (<span class="hljs-name">org-roam-node-file</span> it))) (<span class="hljs-name">kill-buffer</span> buf)) nodes)
  (<span class="hljs-name">run-elp</span> &#x27;org-roam-ql--get-file-marker nodes))
</code></pre>
<p>Results:</p>
<pre><code class="hljs language-csv">  Function Name                                                    Call Count  Elapsed Time  Average Time
org-roam-ql--get-file-marker                                       55          49.118194999  0.8930580909
org-mode                                                           55          1.94798       0.0354178181
org-display-inline-images                                          55          0.169515      0.0030820909
org-fold-core-fontify-region                                       55          0.1608879999  0.0029252363
org-activate-links                                                 525         0.1235360000  0.0002353066
org-activate-links--text-properties                                525         0.1225479999  0.0002334247
org-ref-cite-activate                                              111         0.0980770000  0.0008835765
org-ref-valid-keys                                                 111         0.09223       0.0008309009
org-install-agenda-files-menu                                      55          0.0870710000  0.0015831090
org-agenda-files                                                   55          0.071968      0.0013085090
org-element-cache-reset                                            55          0.0703109999  0.0012783818
org-cycle-set-startup-visibility                                   55          0.064626      0.0011750181
org-fold--hide-drawers                                             110         0.0564499999  0.0005131818
org-cycle-hide-drawers                                             55          0.0563539999  0.0010246181
org-fold--hide-drawers--text-properties                            110         0.0561990000  0.0005109000
org-fold-initialize                                                55          0.0515590000  0.0009374363
org-element-at-point                                               102         0.0514149999  0.0005040686
org-fold-core-initialize                                           55          0.051243      0.0009316909
org-element--parse-to                                              104         0.0491009999  0.0004721249
org-element--cache-setup-change-functions                          55          0.035294      0.0006417090
org-persist-register                                               110         0.0338739999  0.0003079454
org-element--current-element                                       296         0.0335950000  0.0001134966
org-persist-load                                                   55          0.0232400000  0.0004225454
org-fold-core-add-folding-spec                                     275         0.0232329999  8.448...e-05
org-persist-read                                                   55          0.0230699999  0.0004194545
org-persist--get-collection                                        165         0.019464      0.0001179636
org-persist--normalize-associated                                  220         0.0168399999  7.654...e-05
org-macro-initialize-templates                                     55          0.016255      0.0002955454
org-fold-core--property-symbol-get-create                          3559        0.0161759999  4.545...e-06
org-get-limited-outline-regexp                                     393         0.0124609999  3.170...e-05
org-element-headline-parser                                        96          0.0120459999  0.0001254791
org-set-regexps-and-options                                        55          0.010741      0.0001952909
org-element--cache-persist-before-read                             110         0.0098299999  8.936...e-05
org-collect-keywords                                               110         0.0061729999  5.611...e-05
org-element--cache-put                                             351         0.005797      1.651...e-05
org-element--get-node-properties                                   151         0.0057880000  3.833...e-05
org-macro--collect-macros                                          55          0.0056149999  0.0001020909
org-fold-core-region                                               378         0.0054469999  1.441...e-05
org--collect-keywords-1                                            110         0.0053270000  4.842...e-05
org-cycle-content                                                  55          0.0047950000  8.718...e-05
org-cycle-content--text-properties                                 55          0.0046260000  8.410...e-05
org-fold-core-set-folding-spec-property                            2805        0.0042610000  1.519...e-06
org-element-org-data-parser                                        55          0.0034479999  6.269...e-05
org-link-get-parameter                                             2821        0.0033830000  1.199...e-06
org-element-link-parser                                            471         0.0031629999  6.715...e-06
org-macro--find-keyword-value                                      220         0.0030170000  1.371...e-05
org-do-emphasis-faces                                              55          0.0029490000  5.361...e-05
org-fold-core-get-folding-spec-from-alias                          7009        0.0029420000  4.197...e-07
org-fold-hide-drawer-toggle                                        101         0.0029130000  2.884...e-05
org-fold--hide-wrapper-toggle                                      101         0.0026870000  2.660...e-05
org-set-font-lock-defaults                                         55          0.002522      4.585...e-05
org-make-options-regexp                                            110         0.0025150000  2.286...e-05
org-setup-filling                                                  55          0.002482      4.512...e-05
org-element--cache-persist-after-read                              110         0.0022579999  2.052...e-05
org-fontify-drawers                                                338         0.0020610000  6.097...e-06
org-element-section-parser                                         95          0.00198       2.084...e-05
org-fold-core-get-folding-spec                                     211         0.0019749999  9.360...e-06
org-element--cache-compare                                         1626        0.0016389999  1.007...e-06
org-unfontify-region                                               55          0.001597      2.903...e-05
org-element-property-drawer-parser                                 94          0.0015959999  1.697...e-05
org-persist-load:elisp                                             110         0.0015889999  1.444...e-05
org-fontify-meta-lines-and-blocks                                  55          0.0014579999  2.650...e-05
org-persist--find-index                                            220         0.0014290000  6.495...e-06
org-ref-find-bibliography                                          111         0.0013189999  1.188...e-05
org-fontify-meta-lines-and-blocks-1                                55          0.0013110000  2.383...e-05
org-ref-org-menu                                                   6           0.001288      0.0002146666
org-cycle-hide-archived-subtrees                                   55          0.001217      2.212...e-05
org-fold-folded-p                                                  101         0.0012159999  1.203...e-05
org-cite-activate                                                  55          0.0011830000  2.150...e-05
org--set-faces-extend                                              110         0.0011719999  1.065...e-05
org-element--cache-verify-element                                  102         0.001169      1.146...e-05
org-cite-get-processor                                             165         0.0010949999  6.636...e-06
org-macro--find-date                                               55          0.0010780000  1.960...e-05
org-fold-hide-archived-subtrees                                    55          0.001039      1.889...e-05
org-fold-show-all--text-properties                                 55          0.0009819999  1.785...e-05
org-element-context                                                1           0.000954      0.000954
org-fold-core-folded-p                                             101         0.0009459999  9.366...e-06
org-transclusion-fontify-meta-lines-and-blocks                     55          0.0009400000  1.709...e-05
org-cycle-show-empty-lines                                         55          0.0008979999  1.632...e-05
org-fontify-inline-src-blocks                                      55          0.0007900000  1.436...e-05
org-element--cache-active-p                                        1318        0.0007860000  5.963...e-07
org-persist--normalize-container                                   660         0.0007540000  1.142...e-06
org-cycle-set-visibility-according-to-property                     55          0.0007300000  1.327...e-05
org-cite-try-load-processor                                        55          0.0006920000  1.258...e-05
org-extract-log-state-settings                                     495         0.0006870000  1.387...e-06
org-element--cache-find                                            102         0.0006750000  6.617...e-06
org-fontify-inline-src-blocks-1                                    55          0.0006400000  1.163...e-05
org-activate-tags                                                  55          0.000629      1.143...e-05
org-activate-footnote-links                                        55          0.0005870000  1.067...e-05
org-cite-processor-has-capability-p                                55          0.0005860000  1.065...e-05
org-font-lock-add-priority-faces                                   55          0.0005580000  1.014...e-05
org-element--cache-sync                                            102         0.0005279999  5.176...e-06
org-fold-core-next-folding-state-change                            55          0.000523      9.509...e-06
org-element-property                                               1716        0.0004930000  2.872...e-07
org-find-invisible-foreground                                      55          0.0004899999  8.909...e-06
org-update-radio-target-regexp                                     55          0.0004709999  8.563...e-06
org-activate-dates                                                 74          0.0004420000  5.972...e-06
org-element--get-global-node-properties                            55          0.0004289999  7.8e-06
org-footnote-next-reference-or-definition                          55          0.0004269999  7.763...e-06
org-fold-hide-drawer-all                                           55          0.0004190000  7.618...e-06
org-file-menu-entry                                                1045        0.0003530000  3.377...e-07
org-at-comment-p                                                   110         0.0003450000  3.136...e-06
org-remove-flyspell-overlays-in                                    772         0.0003380000  4.378...e-07
org-activate-code                                                  55          0.0003290000  5.981...e-06
org-babel-hide-all-hashes                                          6           0.000317      5.283...e-05
org-delete-all                                                     110         0.0003099999  2.818...e-06
org-do-latex-and-related                                           55          0.0002539999  4.618...e-06
org-element--get-time-properties                                   96          0.0002169999  2.260...e-06
org-get-level-face                                                 318         0.0002029999  6.383...e-07
org-remove-keyword-keys                                            110         0.0001999999  1.818...e-06
org-ref-cite-version                                               111         0.0001989999  1.792...e-06
org-bullets-mode                                                   6           0.0001970000  3.283...e-05
org-skip-whitespace                                                353         0.0001879999  5.325...e-07
org-setup-comments-handling                                        55          0.0001849999  3.363...e-06
org-transclusion-font-lock-set                                     55          0.0001769999  3.218...e-06
org-macro--counter-initialize                                      55          0.0001759999  3.199...e-06
org-element--collect-affiliated-keywords                           10          0.00017       1.7e-05
org-fold-core--isearch-setup                                       55          0.0001629999  2.963...e-06
org-knuth-hash                                                     102         0.0001439999  1.411...e-06
org-element-drawer-parser                                          9           0.000141      1.566...e-05
org-re-property                                                    55          0.0001389999  2.527...e-06
org-fontify-macros                                                 55          0.0001319999  2.399...e-06
org-element-timestamp-parser                                       6           0.0001300000  2.166...e-05
org-compute-latex-and-related-regexp                               55          0.0001139999  2.072...e-06
org-macro--set-templates                                           55          0.0001139999  2.072...e-06
org-element-planning-parser                                        3           0.000112      3.733...e-05
org-assign-fast-keys                                               55          0.0001119999  2.036...e-06
org-load-modules-maybe                                             55          0.0001049999  1.909...e-06
org-string-nw-p                                                    55          0.0001029999  1.872...e-06
org-element-restriction                                            55          9.899...e-05  1.799...e-06
org-fold-core--check-spec                                          55          9.799...e-05  1.781...e-06
org-tag-alist-to-groups                                            55          8.899...e-05  1.618...e-06
org-remove-inline-images                                           55          7.899...e-05  1.436...e-06
org-reduced-level                                                  96          7.299...e-05  7.604...e-07
org-get-todo-face                                                  18          7.2e-05       4e-06
org-remove-font-lock-display-properties                            55          7.199...e-05  1.309...e-06
org-element-type                                                   202         6.399...e-05  3.168...e-07
org-file-name-concat                                               55          5.899...e-05  1.072...e-06
org-element--object-lex                                            1           5.7e-05       5.7e-05
org-element-parse-secondary-string                                 55          5.499...e-05  9.999...e-07
org-font-lock-hook                                                 55          5.199...e-05  9.454...e-07
org-activate-target-links                                          55          4.499...e-05  8.181...e-07
org-fontify-entities                                               55          3.899...e-05  7.090...e-07
org--tag-add-to-alist                                              55          3.5e-05       6.363...e-07
org-raise-scripts                                                  55          3.000...e-05  5.454...e-07
org-parse-time-string                                              6           2.7e-05       4.5e-06
org-fold-core-update-optimisation                                  55          2.500...e-05  4.545...e-07
org-font-lock-add-tag-faces                                        55          2.300...e-05  4.181...e-07
org-eldoc-load                                                     6           1.9e-05       3.166...e-06
org-element-paragraph-parser                                       1           1.3e-05       1.3e-05
org-babel-result-hide-spec                                         6           1.099...e-05  1.833...e-06
org-bullets--fontify-buffer                                        6           9.999...e-06  1.666...e-06
org-link-expand-abbrev                                             2           8e-06         4e-06
org-face-from-face-or-color                                        19          4.999...e-06  2.631...e-07
org-link-unescape                                                  2           4e-06         2e-06
org-get-priority-face                                              1           3e-06         3e-06
org-item-re                                                        1           2e-06         2e-06
org-element-lineage                                                1           1e-06         1e-06
</code></pre>
<h3>Test with <code>org-roam-with-file</code></h3>
<pre><code class="hljs language-lisp">(<span class="hljs-name">defun</span> org-roam-ql--get-file-marker (<span class="hljs-name">node</span>)
  (<span class="hljs-name">org-roam-with-file</span> (<span class="hljs-name">org-roam-node-file</span> node) <span class="hljs-literal">t</span>
    (<span class="hljs-name">goto-char</span> (<span class="hljs-name">org-roam-node-point</span> node))
    (<span class="hljs-name">point-marker</span>)))

(<span class="hljs-name">let</span> ((<span class="hljs-name">nodes</span> (<span class="hljs-name">--map</span> (<span class="hljs-name">org-roam-node-from-id</span> it) random-node-ids)))
  (<span class="hljs-name">--map</span> (<span class="hljs-name">when-let</span> (<span class="hljs-name">buf</span> (<span class="hljs-name">find-buffer-visiting</span> (<span class="hljs-name">org-roam-node-file</span> it))) (<span class="hljs-name">kill-buffer</span> buf)) nodes)
  (<span class="hljs-name">run-elp</span> &#x27;org-roam-ql--get-file-marker nodes))
</code></pre>
<p>Results:</p>
<pre><code class="hljs language-csv">  Function Name                                                    Call Count  Elapsed Time  Average Time
org-roam-ql--get-file-marker                                       55          43.752767999  0.7955048727
org-mode                                                           55          0.272921      0.0049622000
org-element-cache-reset                                            55          0.0759590000  0.0013810727
org-fold-initialize                                                55          0.0505179999  0.0009185090
org-fold-core-initialize                                           55          0.050176      0.0009122909
org-persist-register                                               110         0.0381199999  0.0003465454
org-element--cache-setup-change-functions                          55          0.0366800000  0.0006669090
org-persist-load                                                   55          0.0242390000  0.0004407090
org-persist-read                                                   55          0.0240559999  0.0004373818
org-fold-core-add-folding-spec                                     275         0.0226350000  8.230...e-05
org-persist--get-collection                                        165         0.0225730000  0.0001368060
org-persist--normalize-associated                                  220         0.0197909999  8.995...e-05
org-macro-initialize-templates                                     55          0.015801      0.0002872909
org-fold-core--property-symbol-get-create                          2475        0.0150779999  6.092...e-06
org-install-agenda-files-menu                                      55          0.0127110000  0.0002311090
org-set-regexps-and-options                                        55          0.0121209999  0.0002203818
org-element--cache-persist-before-read                             110         0.0099919999  9.083...e-05
org-collect-keywords                                               110         0.007386      6.714...e-05
org--collect-keywords-1                                            110         0.006386      5.805...e-05
org-macro--collect-macros                                          55          0.00541       9.836...e-05
org-fold-core-set-folding-spec-property                            2805        0.0042220000  1.505...e-06
org-macro--find-keyword-value                                      220         0.0028549999  1.297...e-05
org-set-font-lock-defaults                                         55          0.0025840000  4.698...e-05
org-make-options-regexp                                            110         0.0025690000  2.335...e-05
org-setup-filling                                                  55          0.00232       4.218...e-05
org-element--cache-persist-after-read                              110         0.0021390000  1.944...e-05
org-fold-core-get-folding-spec-from-alias                          4950        0.0021289999  4.301...e-07
org-persist-load:elisp                                             110         0.0015319999  1.392...e-05
org-persist--find-index                                            220         0.0014970000  6.804...e-06
org--set-faces-extend                                              110         0.0012109999  1.100...e-05
org-macro--find-date                                               55          0.0010879999  1.978...e-05
org-persist--normalize-container                                   660         0.0008620000  1.306...e-06
org-cite-try-load-processor                                        55          0.0007179999  1.305...e-05
org-extract-log-state-settings                                     495         0.0006690000  1.351...e-06
org-cite-get-processor                                             55          0.0005470000  9.945...e-06
org-find-invisible-foreground                                      55          0.0005280000  9.600...e-06
org-update-radio-target-regexp                                     55          0.000456      8.290...e-06
org-delete-all                                                     110         0.0002979999  2.709...e-06
org-remove-keyword-keys                                            110         0.0002189999  1.990...e-06
org-transclusion-font-lock-set                                     55          0.0001929999  3.509...e-06
org-fold-core--isearch-setup                                       55          0.0001829999  3.327...e-06
org-setup-comments-handling                                        55          0.0001739999  3.163...e-06
org-macro--counter-initialize                                      55          0.0001449999  2.636...e-06
org-macro--set-templates                                           55          0.0001159999  2.109...e-06
org-compute-latex-and-related-regexp                               55          0.0001149999  2.090...e-06
org-assign-fast-keys                                               55          0.0001089999  1.981...e-06
org-agenda-files                                                   55          0.0001079999  1.963...e-06
org-element-restriction                                            55          0.0001069999  1.945...e-06
org-load-modules-maybe                                             55          9.799...e-05  1.781...e-06
org-tag-alist-to-groups                                            55          8.999...e-05  1.636...e-06
org-file-name-concat                                               55          5.499...e-05  9.999...e-07
org-element-parse-secondary-string                                 55          5.099...e-05  9.272...e-07
org--tag-add-to-alist                                              55          2.900...e-05  5.272...e-07
</code></pre>
<h3>Test with <code>with-plain-file</code></h3>
<pre><code class="hljs language-lisp">(<span class="hljs-name">defun</span> org-roam-ql--get-file-marker (<span class="hljs-name">node</span>)
  (<span class="hljs-name">with-plain-file</span> (<span class="hljs-name">org-roam-node-file</span> node) <span class="hljs-literal">t</span>
    (<span class="hljs-name">goto-char</span> (<span class="hljs-name">org-roam-node-point</span> node))
    (<span class="hljs-name">point-marker</span>)))

(<span class="hljs-name">let</span> ((<span class="hljs-name">nodes</span> (<span class="hljs-name">--map</span> (<span class="hljs-name">org-roam-node-from-id</span> it) random-node-ids)))
  (<span class="hljs-name">--map</span> (<span class="hljs-name">when-let</span> (<span class="hljs-name">buf</span> (<span class="hljs-name">find-buffer-visiting</span> (<span class="hljs-name">org-roam-node-file</span> it))) (<span class="hljs-name">kill-buffer</span> buf)) nodes)
  (<span class="hljs-name">run-elp</span> &#x27;org-roam-ql--get-file-marker nodes))
</code></pre>
<p>Results:</p>
<pre><code class="hljs language-csv">  Function Name                                                    Call Count  Elapsed Time  Average Time
org-roam-ql--get-file-marker                                       55          28.741321999  0.5225694909
</code></pre>
<h2>Testing with <code>emacs -Q</code> (org version <code>9.5.4-g5a6442</code>)</h2>
<p>The tests in the above as well this uses the following org version</p>
<pre><code class="hljs language-sh">Org mode version 9.5.4 (9.5.4-g5a6442 @ ~/.emacs.d/straight/build/org/)
</code></pre>
<p>The above tests were done with the all my setting running. So I also tested it out with <code>emacs -q</code>.</p>
<p>I first run emacs with <code>-Q</code> with straight bootstrapped:</p>
<pre><code class="hljs language-sh">emacs -Q -l ~/.emacs.d/straight/repos/straight.el/bootstrap.el
</code></pre>
<p>Then run the following script:</p>
<pre><code class="hljs language-lisp">(<span class="hljs-name">straight-use-package</span> &#x27;org)
(<span class="hljs-name">straight-use-package</span> &#x27;org-roam)

(<span class="hljs-name">defun</span> run-elp (<span class="hljs-name">func</span> sources)
  <span class="hljs-string">&quot;Instrument org and FUNC and iterate on SOURCES with FUNC.
FUNC is a sumbol representing a function that takes one parameter.
SOURCES is a list of element that will be processed by FUNC&quot;</span>
  (<span class="hljs-name">elp-instrument-package</span> <span class="hljs-string">&quot;org&quot;</span>)
  (<span class="hljs-name">elp-instrument-function</span> func)
  (<span class="hljs-name">elp-reset-all</span>)
  (<span class="hljs-name">mapcar</span> func sources)
  (<span class="hljs-name">elp-results</span>))

(<span class="hljs-name">defmacro</span> with-plain-file (<span class="hljs-name">file</span> keep-buf-p <span class="hljs-symbol">&amp;rest</span> body)
  <span class="hljs-string">&quot;Same as `org-roam-with-file&#x27;, but doesn&#x27;t start `org-roam&#x27;.&quot;</span>
  (<span class="hljs-name">declare</span> (<span class="hljs-name">indent</span> <span class="hljs-number">2</span>) (<span class="hljs-name">debug</span> <span class="hljs-literal">t</span>))
  `(let* (new-buf
          (auto-mode-alist <span class="hljs-literal">nil</span>)
          (find-file-hook <span class="hljs-literal">nil</span>)
          (buf (or
                (and (not ,file)
                     (current-buffer)) ;If FILE is <span class="hljs-literal">nil</span>, use current buffer
                (find-buffer-visiting ,file) ; If FILE is already visited, find buffer
                (progn
                  (setq new-buf <span class="hljs-literal">t</span>)
                  (find-file-noselect ,file)))) ; Else, visit FILE and return buffer
          res)
     (with-current-buffer buf
       (setq res (progn ,@body))
       (unless (and new-buf (not ,keep-buf-p))
         (save-buffer)))
     (if (and new-buf (not ,keep-buf-p))
         (when (find-buffer-visiting ,file)
           (kill-buffer (find-buffer-visiting ,file))))
     res))

(<span class="hljs-name">defun</span> test-org-load-files (<span class="hljs-name">func</span> <span class="hljs-symbol">&amp;optional</span> restart)
  (<span class="hljs-name">let</span> ((<span class="hljs-name">test-dir</span> <span class="hljs-string">&quot;~/temp/org-mode-test/&quot;</span>)
        files)
    (<span class="hljs-name">message</span> <span class="hljs-string">&quot;Tests running&quot;</span>)
    (<span class="hljs-name">when</span> (<span class="hljs-name">and</span> (<span class="hljs-name">file-exists-p</span> test-dir) restart)
      (<span class="hljs-name">dolist</span> (<span class="hljs-name">f</span> (<span class="hljs-name">directory-files</span> (<span class="hljs-name">file-truename</span> test-dir))) (<span class="hljs-name">unless</span> (<span class="hljs-name">member</span> f &#x27;(<span class="hljs-string">&quot;.&quot;</span> <span class="hljs-string">&quot;..&quot;</span>)) (<span class="hljs-name">delete-file</span> f)))
      (<span class="hljs-name">delete-directory</span> (<span class="hljs-name">file-truename</span> test-dir) <span class="hljs-literal">t</span>))

    (<span class="hljs-name">if</span> (<span class="hljs-name">or</span> restart (<span class="hljs-name">not</span> (<span class="hljs-name">file-exists-p</span> test-dir)))
        (<span class="hljs-name">progn</span>
          (<span class="hljs-name">make-directory</span> (<span class="hljs-name">file-truename</span> test-dir))
          <span class="hljs-comment">;; generating a bunch of file for testing</span>
          (<span class="hljs-name">dolist</span> (<span class="hljs-name">num</span> (<span class="hljs-name">number-sequence</span> <span class="hljs-number">1</span> <span class="hljs-number">25</span> <span class="hljs-number">1</span>))
            (<span class="hljs-name">let</span> ((<span class="hljs-name">auto-mode-alist</span> <span class="hljs-literal">nil</span>)
                  (<span class="hljs-name">find-file-hook</span> <span class="hljs-literal">nil</span>)
                  (<span class="hljs-name">id</span> (<span class="hljs-name">org-id-new</span>))
                  (<span class="hljs-name">f</span> (<span class="hljs-name">file-truename</span> (<span class="hljs-name">format</span> <span class="hljs-string">&quot;~/temp/org-roam-test/test_%s.org&quot;</span> num))))
              (<span class="hljs-name">push</span> f files)
              (<span class="hljs-name">with-current-buffer</span> (<span class="hljs-name">find-file-noselect</span> f)
                (<span class="hljs-name">erase-buffer</span>)
                (<span class="hljs-name">insert</span> (<span class="hljs-name">format</span> <span class="hljs-string">&quot;* This is the heading in file number %s
  :PROPERTIES:
  :ID:       %s
  :TEST_PROP_1: %s
  :TEST_PROP_2: id:%s
  :END:&quot;</span> num id num id))
                (<span class="hljs-name">save-buffer</span>)
                (<span class="hljs-name">kill-buffer</span> (<span class="hljs-name">find-buffer-visiting</span> f))))))
      (<span class="hljs-name">progn</span>
        (<span class="hljs-name">mapcar</span> (<span class="hljs-name">lambda</span> (<span class="hljs-name">f</span>) (<span class="hljs-name">let</span> ((<span class="hljs-name">f</span> (<span class="hljs-name">find-buffer-visiting</span> f)))
                              (<span class="hljs-name">em</span> f)
                              (<span class="hljs-name">when</span> f
                                (<span class="hljs-name">kill-buffer</span> f))))
                (<span class="hljs-name">setq</span> files (<span class="hljs-name">f-glob</span> <span class="hljs-string">&quot;*.org&quot;</span> test-dir)))))

    (<span class="hljs-name">run-elp</span> func files)
    (<span class="hljs-name">with-current-buffer</span> <span class="hljs-string">&quot;*ELP Profiling Results*&quot;</span>
      (<span class="hljs-name">write-file</span> (<span class="hljs-name">format</span> <span class="hljs-string">&quot;~/elp_results_%s&quot;</span> func (<span class="hljs-name">format-time-string</span> <span class="hljs-string">&quot;%Y-%m-%dT%H-%M-%S%-z&quot;</span>))))))

(<span class="hljs-name">defun</span> --test-org-roam-with-file (<span class="hljs-name">f</span>)
  (<span class="hljs-name">org-roam-with-file</span> f <span class="hljs-literal">t</span>
    (<span class="hljs-name">goto-char</span> <span class="hljs-number">3</span>)
    (<span class="hljs-name">point-marker</span>)))

(<span class="hljs-name">defun</span> --test-with-current-buffer (<span class="hljs-name">f</span>)
  (<span class="hljs-name">with-current-buffer</span> (<span class="hljs-name">find-file-noselect</span> f)
    (<span class="hljs-name">goto-char</span> <span class="hljs-number">3</span>)
    (<span class="hljs-name">point-marker</span>)))

(<span class="hljs-name">defun</span> --test-with-plain-file (<span class="hljs-name">f</span>)
  (<span class="hljs-name">with-plain-file</span> f <span class="hljs-literal">t</span>
    (<span class="hljs-name">goto-char</span> <span class="hljs-number">3</span>)
    (<span class="hljs-name">point-marker</span>)))

(<span class="hljs-name">setq</span> org-roam-directory (<span class="hljs-name">file-truename</span> <span class="hljs-string">&quot;~/temp/org-mode-test/&quot;</span>))
(<span class="hljs-name">setq</span> org-roam-node-display-template (<span class="hljs-name">concat</span> <span class="hljs-string">&quot;<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#x27;EOF&#x27;, got &#x27;&amp;&#x27; at position 11: {title:*} &amp;̲quot;&lt;/span&gt; (&lt;…" style="color:#cc0000">{title:*} &amp;quot;&lt;/span&gt; (&lt;span class=&quot;hljs-name&quot;&gt;propertize&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;</span>{tags:10}&quot;</span> &#x27;face &#x27;org-tag)))
(<span class="hljs-name">org-roam-db-autosync-mode</span>)

(<span class="hljs-name">with-eval-after-load</span> &#x27;org-roam
  <span class="hljs-comment">;; running twice to so that the first time around module loading won&#x27;t effect times</span>
  (<span class="hljs-name">dolist</span> (<span class="hljs-name">func</span> &#x27;(--test-org-roam-with-file
                  --test-with-current-buffer
                  --test-with-plain-file))
    (<span class="hljs-name">test-org-load-files</span> func <span class="hljs-literal">t</span>))

  (<span class="hljs-name">dolist</span> (<span class="hljs-name">func</span> &#x27;(--test-org-roam-with-file
                  --test-with-current-buffer
                  --test-with-plain-file))
    (<span class="hljs-name">test-org-load-files</span> func <span class="hljs-literal">t</span>)))
</code></pre>
<p>The results are as follows:</p>
<h3>Run 1:</h3>
<h4>With <code>with-current-buffer</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-current-buffer                               25          0.3538700000  0.0141548000
org-mode                                                 25          0.078992      0.00315968
org-roam-db-autosync--setup-file-h                       25          0.0404749999  0.0016189999
org-roam-file-p                                          25          0.0404000000  0.0016160000
org-roam-descendant-of-p                                 25          0.039471      0.00157884
org-set-regexps-and-options                              25          0.0356599999  0.0014263999
org-collect-keywords                                     50          0.0348489999  0.0006969799
org-fold-initialize                                      25          0.00966       0.0003864
org-fold-core-initialize                                 25          0.009571      0.0003828399
org-fold-core-add-folding-spec                           125         0.0088600000  7.088...e-05
org-element-cache-reset                                  25          0.006279      0.00025116
org-fold-core--property-symbol-get-create                1200        0.0058570000  4.880...e-06
org-persist-register                                     50          0.005518      0.0001103600
org-macro-initialize-templates                           25          0.005454      0.0002181599
org-persist--get-collection                              75          0.0051669999  6.889...e-05
org-persist--normalize-associated                        100         0.0042320000  4.232...e-05
org-fold-core-set-folding-spec-property                  1275        0.0016609999  1.302...e-06
org-install-agenda-files-menu                            25          0.0015780000  6.312e-05
org--collect-keywords-1                                  50          0.0012510000  2.502...e-05
org-macro--collect-macros                                25          0.00106       4.24e-05
org-make-options-regexp                                  50          0.0008890000  1.778...e-05
org-fold-core-get-folding-spec-from-alias                2400        0.0008710000  3.629...e-07
org-cycle-set-startup-visibility                         25          0.0007679999  3.071...e-05
org-fold-show-all--text-properties                       25          0.0007039999  2.815...e-05
org-fold-core-region                                     75          0.0005510000  7.346...e-06
org-set-font-lock-defaults                               25          0.0004940000  1.976...e-05
org-element--cache-setup-change-functions                25          0.0004249999  1.699...e-05
org-persist--find-index                                  75          0.0003999999  5.333...e-06
org-macro--find-keyword-value                            100         0.0003710000  3.710...e-06
org--set-faces-extend                                    50          0.000254      5.08e-06
org-macro--find-date                                     25          0.000247      9.88e-06
org-persist--normalize-container                         250         0.0002429999  9.719...e-07
org-cite-try-load-processor                              25          0.0002270000  9.080...e-06
org-babel-hide-all-hashes                                25          0.0002170000  8.680...e-06
org-setup-filling                                        25          0.0001920000  7.680...e-06
org-cite-get-processor                                   25          0.0001680000  6.720...e-06
org-find-invisible-foreground                            25          0.0001590000  6.360...e-06
org-persist-load                                         25          0.0001530000  6.120...e-06
org-update-radio-target-regexp                           25          0.000132      5.28e-06
org-persist-read                                         25          0.0001030000  4.120...e-06
org-roam--file-name-extension                            25          8.300...e-05  3.320...e-06
org-assign-fast-keys                                     25          7.9e-05       3.16e-06
org-extract-log-state-settings                           50          7.799...e-05  1.559...e-06
org-setup-comments-handling                              25          5.400...e-05  2.16e-06
org-macro--counter-initialize                            25          4.900...e-05  1.960...e-06
org-fold-core--isearch-setup                             25          4.700...e-05  1.880...e-06
org-compute-latex-and-related-regexp                     25          4.2e-05       1.68e-06
org-macro--set-templates                                 25          4.100...e-05  1.640...e-06
org-element-restriction                                  25          3.3e-05       1.32e-06
org-agenda-files                                         25          3.200...e-05  1.280...e-06
org-load-modules-maybe                                   25          2.900...e-05  1.160...e-06
org-delete-all                                           25          2.400...e-05  9.600...e-07
org-element-parse-secondary-string                       25          2.300...e-05  9.200...e-07
org-babel-result-hide-spec                               25          2.200...e-05  8.800...e-07
org-tag-alist-to-groups                                  25          1.300...e-05  5.200...e-07
org--tag-add-to-alist                                    25          1.200...e-05  4.800...e-07
</code></pre>
<h4>with <code>org-roam-with-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-org-roam-with-file                                25          0.3233730000  0.0129349200
org-mode                                                 25          0.070406      0.00281624
org-fold-initialize                                      25          0.0493970000  0.0019758800
org-fold-core-initialize                                 25          0.0493009999  0.0019720399
org-fold-core-add-folding-spec                           125         0.0486619999  0.0003892959
org-fold-core--property-symbol-get-create                1125        0.0450600000  4.005...e-05
org-element-cache-reset                                  25          0.0068629999  0.00027452
org-persist-register                                     50          0.006138      0.00012276
org-macro-initialize-templates                           25          0.006024      0.00024096
org-persist--get-collection                              75          0.0057329999  7.643...e-05
org-persist--normalize-associated                        100         0.0046360000  4.636...e-05
org-set-regexps-and-options                              25          0.0025940000  0.0001037600
org-fold-core-set-folding-spec-property                  1275        0.0019359999  1.518...e-06
org-collect-keywords                                     50          0.001671      3.342e-05
org-install-agenda-files-menu                            25          0.0015079999  6.031...e-05
org--collect-keywords-1                                  50          0.0013849999  2.769...e-05
org-macro--collect-macros                                25          0.00117       4.68e-05
org-fold-core-get-folding-spec-from-alias                2250        0.0010050000  4.466...e-07
org-make-options-regexp                                  50          0.000976      1.952e-05
org-set-font-lock-defaults                               25          0.0005629999  2.251...e-05
org-persist--find-index                                  75          0.0004639999  6.186...e-06
org-macro--find-keyword-value                            100         0.0004170000  4.170...e-06
org-element--cache-setup-change-functions                25          0.000342      1.368...e-05
org-persist--normalize-container                         250         0.0002679999  1.071...e-06
org-macro--find-date                                     25          0.000261      1.044e-05
org-cite-try-load-processor                              25          0.0002520000  1.008...e-05
org--set-faces-extend                                    50          0.0002420000  4.84e-06
org-setup-filling                                        25          0.0002040000  8.160...e-06
org-cite-get-processor                                   25          0.0001850000  7.400...e-06
org-persist-load                                         25          0.0001790000  7.160...e-06
org-find-invisible-foreground                            25          0.0001580000  6.320...e-06
org-update-radio-target-regexp                           25          0.0001490000  5.960...e-06
org-persist-read                                         25          0.0001200000  4.800...e-06
org-assign-fast-keys                                     25          9.000...e-05  3.600...e-06
org-extract-log-state-settings                           50          8.199...e-05  1.639...e-06
org-setup-comments-handling                              25          6.2e-05       2.48e-06
org-macro--counter-initialize                            25          5.4e-05       2.16e-06
org-fold-core--isearch-setup                             25          5.300...e-05  2.120...e-06
org-compute-latex-and-related-regexp                     25          4.800...e-05  1.920...e-06
org-roam-with-file                                       25          4.700...e-05  1.880...e-06
org-macro--set-templates                                 25          4.400...e-05  1.760...e-06
org-agenda-files                                         25          3.100...e-05  1.240...e-06
org-load-modules-maybe                                   25          2.800...e-05  1.120...e-06
org-element-restriction                                  25          2.700...e-05  1.080...e-06
org-delete-all                                           25          2.100...e-05  8.400...e-07
org-element-parse-secondary-string                       25          1.700...e-05  6.800...e-07
org-tag-alist-to-groups                                  25          1.600...e-05  6.400...e-07
org--tag-add-to-alist                                    25          1.400...e-05  5.600...e-07
</code></pre>
<h4>With <code>with-plain-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-plain-file                                   25          0.2287930000  0.00915172
</code></pre>
<h3>Run 2:</h3>
<h4>With <code>with-current-buffer</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-current-buffer                               25          0.3539380000  0.0141575200
org-mode                                                 25          0.0802119999  0.0032084799
org-fold-initialize                                      25          0.044382      0.00177528
org-fold-core-initialize                                 25          0.0442840000  0.0017713600
org-fold-core-add-folding-spec                           125         0.0435089999  0.0003480719
org-roam-db-autosync--setup-file-h                       25          0.0406990000  0.0016279600
org-roam-file-p                                          25          0.040631      0.00162524
org-fold-core--property-symbol-get-create                1200        0.0404260000  3.368...e-05
org-roam-descendant-of-p                                 25          0.039682      0.0015872800
org-element-cache-reset                                  25          0.00642       0.0002568
org-persist-register                                     50          0.005617      0.00011234
org-macro-initialize-templates                           25          0.0054350000  0.0002174000
org-persist--get-collection                              75          0.0052669999  7.022...e-05
org-persist--normalize-associated                        100         0.0042980000  4.298...e-05
org-set-regexps-and-options                              25          0.002329      9.316e-05
org-fold-core-set-folding-spec-property                  1275        0.0017129999  1.343...e-06
org-install-agenda-files-menu                            25          0.0015840000  6.336e-05
org-collect-keywords                                     50          0.0014700000  2.940...e-05
org--collect-keywords-1                                  50          0.001206      2.412e-05
org-macro--collect-macros                                25          0.001069      4.276...e-05
org-fold-core-get-folding-spec-from-alias                2400        0.0009050000  3.770...e-07
org-make-options-regexp                                  50          0.0008660000  1.732...e-05
org-cycle-set-startup-visibility                         25          0.000733      2.932e-05
org-fold-show-all--text-properties                       25          0.0006640000  2.656...e-05
org-set-font-lock-defaults                               25          0.000519      2.076e-05
org-fold-core-region                                     75          0.0005090000  6.786...e-06
org-element--cache-setup-change-functions                25          0.000457      1.828e-05
org-persist--find-index                                  75          0.0004219999  5.626...e-06
org-macro--find-keyword-value                            100         0.0003710000  3.710...e-06
org--set-faces-extend                                    50          0.0002789999  5.579...e-06
org-macro--find-date                                     25          0.0002430000  9.720...e-06
org-cite-try-load-processor                              25          0.0002420000  9.68e-06
org-persist--normalize-container                         250         0.0002409999  9.639...e-07
org-setup-filling                                        25          0.0002060000  8.24e-06
org-babel-hide-all-hashes                                25          0.0001920000  7.680...e-06
org-cite-get-processor                                   25          0.0001720000  6.880...e-06
org-persist-load                                         25          0.000167      6.679...e-06
org-find-invisible-foreground                            25          0.000153      6.12e-06
org-update-radio-target-regexp                           25          0.000135      5.4e-06
org-persist-read                                         25          0.0001070000  4.280...e-06
org-roam--file-name-extension                            25          8.700...e-05  3.480...e-06
org-assign-fast-keys                                     25          8.2e-05       3.28e-06
org-extract-log-state-settings                           50          7.699...e-05  1.539...e-06
org-setup-comments-handling                              25          5.600...e-05  2.240...e-06
org-fold-core--isearch-setup                             25          4.800...e-05  1.920...e-06
org-macro--counter-initialize                            25          4.3e-05       1.72e-06
org-compute-latex-and-related-regexp                     25          4.100...e-05  1.640...e-06
org-macro--set-templates                                 25          4e-05         1.600...e-06
org-agenda-files                                         25          3.300...e-05  1.320...e-06
org-element-restriction                                  25          2.900...e-05  1.160...e-06
org-load-modules-maybe                                   25          2.700...e-05  1.080...e-06
org-delete-all                                           25          2.500...e-05  1.000...e-06
org-element-parse-secondary-string                       25          1.900...e-05  7.600...e-07
org-babel-result-hide-spec                               25          1.600...e-05  6.400...e-07
org--tag-add-to-alist                                    25          1.300...e-05  5.200...e-07
org-tag-alist-to-groups                                  25          1.200...e-05  4.800...e-07
</code></pre>
<h4>with <code>org-roam-with-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-org-roam-with-file                                25          0.299792      0.01199168
org-mode                                                 25          0.0647949999  0.0025917999
org-fold-initialize                                      25          0.0450550000  0.0018022000
org-fold-core-initialize                                 25          0.0449510000  0.0017980400
org-fold-core-add-folding-spec                           125         0.0443579999  0.0003548639
org-element-cache-reset                                  25          0.006359      0.00025436
org-fold-core--property-symbol-get-create                1125        0.0061050000  5.426...e-06
org-persist-register                                     50          0.005664      0.00011328
org-macro-initialize-templates                           25          0.005647      0.00022588
org-persist--get-collection                              75          0.0053229999  7.097...e-05
org-persist--normalize-associated                        100         0.0043520000  4.352...e-05
org-set-regexps-and-options                              25          0.002292      9.168e-05
org-fold-core-set-folding-spec-property                  1275        0.0017909999  1.404...e-06
org-install-agenda-files-menu                            25          0.0015469999  6.187...e-05
org-collect-keywords                                     50          0.0014850000  2.970...e-05
org--collect-keywords-1                                  50          0.00122       2.44e-05
org-macro--collect-macros                                25          0.0011669999  4.667...e-05
org-make-options-regexp                                  50          0.0008790000  1.758...e-05
org-fold-core-get-folding-spec-from-alias                2250        0.0008740000  3.884...e-07
org-set-font-lock-defaults                               25          0.0004860000  1.944...e-05
org-persist--find-index                                  75          0.0004259999  5.679...e-06
org-macro--find-keyword-value                            100         0.0004060000  4.060...e-06
org-element--cache-setup-change-functions                25          0.0003270000  1.308...e-05
org-macro--find-date                                     25          0.0002650000  1.060...e-05
org--set-faces-extend                                    50          0.000264      5.28e-06
org-persist--normalize-container                         250         0.0002429999  9.719...e-07
org-cite-try-load-processor                              25          0.0002250000  9.000...e-06
org-setup-filling                                        25          0.0001910000  7.640...e-06
org-persist-load                                         25          0.0001780000  7.120...e-06
org-cite-get-processor                                   25          0.0001670000  6.680...e-06
org-find-invisible-foreground                            25          0.0001640000  6.560...e-06
org-update-radio-target-regexp                           25          0.0001370000  5.480...e-06
org-persist-read                                         25          0.0001130000  4.520...e-06
org-assign-fast-keys                                     25          8.200...e-05  3.280...e-06
org-extract-log-state-settings                           50          7.499...e-05  1.499...e-06
org-setup-comments-handling                              25          5.8e-05       2.32e-06
org-roam-with-file                                       25          5.2e-05       2.08e-06
org-fold-core--isearch-setup                             25          4.8e-05       1.920...e-06
org-macro--set-templates                                 25          4.500...e-05  1.800...e-06
org-macro--counter-initialize                            25          4.3e-05       1.72e-06
org-compute-latex-and-related-regexp                     25          3.9e-05       1.559...e-06
org-agenda-files                                         25          3.5e-05       1.4e-06
org-load-modules-maybe                                   25          3.3e-05       1.32e-06
org-element-restriction                                  25          3.100...e-05  1.240...e-06
org-delete-all                                           25          2.900...e-05  1.160...e-06
org-element-parse-secondary-string                       25          2.400...e-05  9.600...e-07
org-tag-alist-to-groups                                  25          1.400...e-05  5.600...e-07
org--tag-add-to-alist                                    25          1.100...e-05  4.400...e-07
</code></pre>
<h4>With <code>with-plain-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-plain-file                                   25          0.2317820000  0.0092712800
</code></pre>
<h3>Run 3</h3>
<h4>With <code>with-current-buffer</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-current-buffer                               25          0.3760549999  0.0150421999
org-mode                                                 25          0.1223050000  0.0048922
org-fold-initialize                                      25          0.0464850000  0.0018594000
org-fold-core-initialize                                 25          0.046367      0.00185468
org-fold-core-add-folding-spec                           125         0.0455039999  0.0003640319
org-roam-db-autosync--setup-file-h                       25          0.0427370000  0.0017094800
org-roam-file-p                                          25          0.0426590000  0.0017063600
org-macro-initialize-templates                           25          0.0422699999  0.0016907999
org-roam-descendant-of-p                                 25          0.0416490000  0.0016659600
org-fold-core-set-folding-spec-property                  1275        0.037526      2.943...e-05
org-macro--collect-macros                                25          0.036222      0.0014488799
org-element-cache-reset                                  25          0.0070009999  0.0002800399
org-fold-core--property-symbol-get-create                1200        0.0065220000  5.435...e-06
org-persist-register                                     50          0.0060450000  0.0001209000
org-persist--get-collection                              75          0.0056679999  7.557...e-05
org-persist--normalize-associated                        100         0.0046470000  4.647...e-05
org-set-regexps-and-options                              25          0.002571      0.00010284
org-collect-keywords                                     50          0.002029      4.058e-05
org-install-agenda-files-menu                            25          0.0017680000  7.072...e-05
org--collect-keywords-1                                  50          0.0017289999  3.457...e-05
org-make-options-regexp                                  50          0.0013410000  2.682...e-05
org-fold-core-get-folding-spec-from-alias                2400        0.0009450000  3.937...e-07
org-cycle-set-startup-visibility                         25          0.0008100000  3.24e-05
org-fold-show-all--text-properties                       25          0.0007339999  2.935...e-05
org-element--cache-setup-change-functions                25          0.000588      2.352e-05
org-fold-core-region                                     75          0.0005740000  7.653...e-06
org-set-font-lock-defaults                               25          0.0005720000  2.288...e-05
org-persist--find-index                                  75          0.000431      5.746...e-06
org-macro--find-keyword-value                            100         0.0004100000  4.100...e-06
org--set-faces-extend                                    50          0.0002759999  5.519...e-06
org-macro--find-date                                     25          0.0002710000  1.084...e-05
org-persist--normalize-container                         250         0.0002639999  1.055...e-06
org-cite-try-load-processor                              25          0.000254      1.016e-05
org-setup-filling                                        25          0.0002430000  9.720...e-06
org-babel-hide-all-hashes                                25          0.0002100000  8.400...e-06
org-cite-get-processor                                   25          0.0001840000  7.360...e-06
org-persist-load                                         25          0.0001760000  7.040...e-06
org-find-invisible-foreground                            25          0.0001680000  6.720...e-06
org-update-radio-target-regexp                           25          0.000152      6.08e-06
org-persist-read                                         25          0.0001150000  4.600...e-06
org-roam--file-name-extension                            25          9.700...e-05  3.880...e-06
org-extract-log-state-settings                           50          9.299...e-05  1.859...e-06
org-assign-fast-keys                                     25          8.600...e-05  3.440...e-06
org-setup-comments-handling                              25          6.000...e-05  2.400...e-06
org-macro--counter-initialize                            25          5.300...e-05  2.120...e-06
org-fold-core--isearch-setup                             25          4.900...e-05  1.960...e-06
org-compute-latex-and-related-regexp                     25          4.5e-05       1.800...e-06
org-macro--set-templates                                 25          4.400...e-05  1.760...e-06
org-element-restriction                                  25          3.6e-05       1.44e-06
org-agenda-files                                         25          3.599...e-05  1.439...e-06
org-load-modules-maybe                                   25          3.000...e-05  1.200...e-06
org-delete-all                                           25          2.900...e-05  1.160...e-06
org-tag-alist-to-groups                                  25          2.100...e-05  8.400...e-07
org-babel-result-hide-spec                               25          2.000...e-05  8.000...e-07
org-element-parse-secondary-string                       25          1.900...e-05  7.600...e-07
org--tag-add-to-alist                                    25          1e-05         4.000...e-07
</code></pre>
<h4>with <code>org-roam-with-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-org-roam-with-file                                25          0.3454239999  0.0138169599
org-mode                                                 25          0.1183370000  0.0047334800
org-set-regexps-and-options                              25          0.0498989999  0.0019959599
org-collect-keywords                                     50          0.0488559999  0.0009771199
org-fold-initialize                                      25          0.047466      0.00189864
org-fold-core-initialize                                 25          0.047341      0.00189364
org-fold-core-add-folding-spec                           125         0.0465069999  0.0003720559
org-fold-core--property-symbol-get-create                1125        0.0426880000  3.794...e-05
org-element-cache-reset                                  25          0.0076450000  0.0003058000
org-persist-register                                     50          0.0066970000  0.0001339400
org-macro-initialize-templates                           25          0.0064580000  0.0002583200
org-persist--get-collection                              75          0.0062649999  8.353...e-05
org-persist--normalize-associated                        100         0.0051300000  5.130...e-05
org-fold-core-set-folding-spec-property                  1275        0.0021109999  1.655...e-06
org-install-agenda-files-menu                            25          0.0019630000  7.852...e-05
org--collect-keywords-1                                  50          0.0015359999  3.072e-05
org-macro--collect-macros                                25          0.001305      5.219...e-05
org-make-options-regexp                                  50          0.001092      2.184e-05
org-fold-core-get-folding-spec-from-alias                2250        0.0010640000  4.728...e-07
org-set-font-lock-defaults                               25          0.000631      2.524...e-05
org-element--cache-setup-change-functions                25          0.000541      2.164...e-05
org-persist--find-index                                  75          0.0004830000  6.440...e-06
org-macro--find-keyword-value                            100         0.0004490000  4.490...e-06
org--set-faces-extend                                    50          0.0003039999  6.079...e-06
org-macro--find-date                                     25          0.0003020000  1.208...e-05
org-setup-filling                                        25          0.0002960000  1.184...e-05
org-cite-try-load-processor                              25          0.0002909999  1.163...e-05
org-persist--normalize-container                         250         0.0002659999  1.063...e-06
org-cite-get-processor                                   25          0.0002160000  8.640...e-06
org-persist-load                                         25          0.0001980000  7.920...e-06
org-find-invisible-foreground                            25          0.0001830000  7.320...e-06
org-update-radio-target-regexp                           25          0.0001600000  6.400...e-06
org-persist-read                                         25          0.0001290000  5.160...e-06
org-assign-fast-keys                                     25          9.400...e-05  3.760...e-06
org-extract-log-state-settings                           50          8.799...e-05  1.759...e-06
org-setup-comments-handling                              25          7.2e-05       2.88e-06
org-fold-core--isearch-setup                             25          5.800...e-05  2.320...e-06
org-macro--counter-initialize                            25          5.600...e-05  2.24e-06
org-roam-with-file                                       25          5.300...e-05  2.120...e-06
org-compute-latex-and-related-regexp                     25          4.8e-05       1.920...e-06
org-macro--set-templates                                 25          4.5e-05       1.800...e-06
org-agenda-files                                         25          4.4e-05       1.759...e-06
org-element-restriction                                  25          3.600...e-05  1.440...e-06
org-load-modules-maybe                                   25          3.599...e-05  1.439...e-06
org-delete-all                                           25          3.100...e-05  1.240...e-06
org-element-parse-secondary-string                       25          2.600...e-05  1.040...e-06
org-tag-alist-to-groups                                  25          1.900...e-05  7.600...e-07
org--tag-add-to-alist                                    25          1.800...e-05  7.200...e-07
</code></pre>
<h4>With <code>with-plain-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-plain-file                                   25          0.2099760000  0.0083990400
</code></pre>
<h2>Test with org version <code>9.5.5-g8cc821</code> in <code>emacs -Q</code></h2>
<p>The same test with <code>emacs -Q</code> with org version:</p>
<pre><code class="hljs language-sh">Org mode version 9.5.5 (9.5.5-g8cc821 @ ~/.emacs.d/straight/build/org/)
</code></pre>
<h3>Run 1</h3>
<h4>With <code>with-current-buffer</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-current-buffer                               25          0.3468619999  0.0138744799
org-mode                                                 25          0.109437      0.00437748
org-fold-initialize                                      25          0.042489      0.00169956
org-fold-core-initialize                                 25          0.0423939999  0.0016957599
org-fold-core-add-folding-spec                           125         0.0417029999  0.0003336239
org-roam-db-autosync--setup-file-h                       25          0.0403400000  0.0016136000
org-roam-file-p                                          25          0.0402700000  0.0016108000
org-roam-descendant-of-p                                 25          0.0393190000  0.0015727600
org-set-regexps-and-options                              25          0.0339719999  0.0013588799
org-collect-keywords                                     50          0.0331579999  0.0006631599
org--collect-keywords-1                                  50          0.0328970000  0.0006579400
org-make-options-regexp                                  50          0.0325419999  0.0006508399
org-element-cache-reset                                  25          0.0062250000  0.0002490000
org-fold-core--property-symbol-get-create                1200        0.0058510000  4.875...e-06
org-persist-register                                     50          0.0054980000  0.0001099600
org-macro-initialize-templates                           25          0.0054269999  0.0002170799
org-persist--get-collection                              75          0.0051739999  6.898...e-05
org-persist--normalize-associated                        100         0.0042200000  4.220...e-05
org-fold-core-set-folding-spec-property                  1150        0.0016499999  1.434...e-06
org-install-agenda-files-menu                            25          0.001484      5.936e-05
org-macro--collect-macros                                25          0.001083      4.332e-05
org-fold-core-get-folding-spec-from-alias                2400        0.0009030000  3.762...e-07
org-cycle-set-startup-visibility                         25          0.0007920000  3.168e-05
org-fold-show-all                                        25          0.0007310000  2.924...e-05
org-fold-region                                          75          0.0006160000  8.213...e-06
org-fold-core-region                                     75          0.0004960000  6.613...e-06
org-set-font-lock-defaults                               25          0.000479      1.916e-05
org-macro--find-keyword-value                            100         0.0004160000  4.160...e-06
org-persist--find-index                                  75          0.0004099999  5.466...e-06
org-element--cache-setup-change-functions                25          0.0003930000  1.572...e-05
org-macro--find-date                                     25          0.0002310000  9.240...e-06
org--set-faces-extend                                    50          0.000231      4.62e-06
org-persist--normalize-container                         250         0.0002249999  8.999...e-07
org-setup-filling                                        25          0.0002200000  8.800...e-06
org-cite-try-load-processor                              25          0.0002130000  8.520...e-06
org-babel-hide-all-hashes                                25          0.0001960000  7.840...e-06
org-cite-get-processor                                   25          0.0001610000  6.440...e-06
org-persist-load                                         25          0.000151      6.040...e-06
org-find-invisible-foreground                            25          0.0001420000  5.680...e-06
org-update-radio-target-regexp                           25          0.000125      5e-06
org-persist-read                                         25          0.0001060000  4.240...e-06
org-roam--file-name-extension                            25          8.400...e-05  3.360...e-06
org-assign-fast-keys                                     25          7.6e-05       3.04e-06
org-extract-log-state-settings                           50          7.399...e-05  1.479...e-06
org-setup-comments-handling                              25          5.299...e-05  2.119...e-06
org-macro--counter-initialize                            25          4.200...e-05  1.680...e-06
org-fold-core--isearch-setup                             25          4.199...e-05  1.679...e-06
org-macro--set-templates                                 25          3.700...e-05  1.480...e-06
org-compute-latex-and-related-regexp                     25          3.7e-05       1.48e-06
org-agenda-files                                         25          3.000...e-05  1.200...e-06
org-element-restriction                                  25          3.000...e-05  1.200...e-06
org-delete-all                                           25          2.600...e-05  1.040...e-06
org-load-modules-maybe                                   25          2.5e-05       1e-06
org-babel-result-hide-spec                               25          2.000...e-05  8.000...e-07
org-element-parse-secondary-string                       25          1.700...e-05  6.800...e-07
org-tag-alist-to-groups                                  25          1.400...e-05  5.600...e-07
org--tag-add-to-alist                                    25          9e-06         3.6e-07

</code></pre>
<h4>with <code>org-roam-with-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-org-roam-with-file                                25          0.3024920000  0.0120996800
org-mode                                                 25          0.0967239999  0.0038689599
org-set-regexps-and-options                              25          0.0352130000  0.0014085200
org-set-font-lock-defaults                               25          0.0344420000  0.0013776800
org-fold-initialize                                      25          0.0100299999  0.0004011999
org-fold-core-initialize                                 25          0.0099269999  0.0003970799
org-fold-core-add-folding-spec                           125         0.0093699999  7.495...e-05
org-element-cache-reset                                  25          0.0066259999  0.0002650399
org-fold-core--property-symbol-get-create                1125        0.0062010000  5.512...e-06
org-persist-register                                     50          0.0059370000  0.0001187400
org-macro-initialize-templates                           25          0.0057430000  0.0002297200
org-persist--get-collection                              75          0.0055909999  7.454...e-05
org-persist--normalize-associated                        100         0.0045920000  4.592...e-05
org-fold-core-set-folding-spec-property                  1150        0.0017669999  1.536...e-06
org-collect-keywords                                     50          0.001493      2.986e-05
org-install-agenda-files-menu                            25          0.0014390000  5.756...e-05
org--collect-keywords-1                                  50          0.0012340000  2.468...e-05
org-macro--collect-macros                                25          0.001156      4.624e-05
org-fold-core-get-folding-spec-from-alias                2250        0.0009180000  4.080...e-07
org-make-options-regexp                                  50          0.0008840000  1.768...e-05
org-macro--find-keyword-value                            100         0.0004440000  4.440...e-06
org-persist--find-index                                  75          0.000423      5.639...e-06
org-element--cache-setup-change-functions                25          0.000332      1.328e-05
org-cite-try-load-processor                              25          0.000253      1.012...e-05
org-macro--find-date                                     25          0.0002520000  1.008...e-05
org-persist--normalize-container                         250         0.0002519999  1.007...e-06
org--set-faces-extend                                    50          0.0002170000  4.340...e-06
org-setup-filling                                        25          0.0002099999  8.4e-06
org-cite-get-processor                                   25          0.0001840000  7.360...e-06
org-persist-load                                         25          0.0001770000  7.080...e-06
org-find-invisible-foreground                            25          0.0001390000  5.560...e-06
org-update-radio-target-regexp                           25          0.000132      5.28e-06
org-persist-read                                         25          0.000128      5.12e-06
org-extract-log-state-settings                           50          8.799...e-05  1.759...e-06
org-assign-fast-keys                                     25          8e-05         3.200...e-06
org-fold-core--isearch-setup                             25          5.400...e-05  2.160...e-06
org-setup-comments-handling                              25          5.3e-05       2.12e-06
org-roam-with-file                                       25          4.3e-05       1.72e-06
org-macro--set-templates                                 25          4.200...e-05  1.680...e-06
org-macro--counter-initialize                            25          4.1e-05       1.64e-06
org-compute-latex-and-related-regexp                     25          3.6e-05       1.44e-06
org-element-restriction                                  25          3.200...e-05  1.280...e-06
org-agenda-files                                         25          3.100...e-05  1.240...e-06
org-delete-all                                           25          2.300...e-05  9.200...e-07
org-load-modules-maybe                                   25          2.100...e-05  8.400...e-07
org-element-parse-secondary-string                       25          1.900...e-05  7.600...e-07
org--tag-add-to-alist                                    25          1.500...e-05  6.000...e-07
org-tag-alist-to-groups                                  25          1.300...e-05  5.200...e-07
</code></pre>
<h4>With <code>with-plain-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-plain-file                                   25          0.190576      0.00762304
</code></pre>
<h3>Run 2</h3>
<h4>With <code>with-current-buffer</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-current-buffer                               25          0.3675650000  0.0147026000
org-roam-db-autosync--setup-file-h                       25          0.0761019999  0.0030440799
org-roam-file-p                                          25          0.0760250000  0.0030410000
org-mode                                                 25          0.0478        0.001912
org-roam-descendant-of-p                                 25          0.0418020000  0.0016720800
org-roam--file-name-extension                            25          0.033206      0.00132824
org-fold-initialize                                      25          0.0102250000  0.0004090000
org-fold-core-initialize                                 25          0.0101079999  0.0004043199
org-fold-core-add-folding-spec                           125         0.0092419999  7.393...e-05
org-element-cache-reset                                  25          0.006654      0.00026616
org-fold-core--property-symbol-get-create                1200        0.0062640000  5.220...e-06
org-persist-register                                     50          0.005767      0.00011534
org-macro-initialize-templates                           25          0.0057529999  0.0002301199
org-persist--get-collection                              75          0.0053749999  7.166...e-05
org-persist--normalize-associated                        100         0.0043510000  4.351...e-05
org-set-regexps-and-options                              25          0.0025109999  0.00010044
org-install-agenda-files-menu                            25          0.0017969999  7.187...e-05
org-fold-core-set-folding-spec-property                  1150        0.0017119999  1.488...e-06
org-collect-keywords                                     50          0.001584      3.167...e-05
org--collect-keywords-1                                  50          0.001289      2.578e-05
org-macro--collect-macros                                25          0.0011589999  4.635...e-05
org-fold-core-get-folding-spec-from-alias                2400        0.0009350000  3.895...e-07
org-make-options-regexp                                  50          0.0009330000  1.866...e-05
org-cycle-set-startup-visibility                         25          0.000837      3.348e-05
org-fold-show-all                                        25          0.000764      3.056e-05
org-fold-region                                          75          0.000628      8.373...e-06
org-set-font-lock-defaults                               25          0.0005530000  2.212...e-05
org-fold-core-region                                     75          0.0005140000  6.853...e-06
org-element--cache-setup-change-functions                25          0.0005120000  2.048...e-05
org-persist--find-index                                  75          0.0004490000  5.986...e-06
org-macro--find-keyword-value                            100         0.0003950000  3.950...e-06
org--set-faces-extend                                    50          0.0002870000  5.740...e-06
org-macro--find-date                                     25          0.000271      1.084e-05
org-persist--normalize-container                         250         0.0002529999  1.011...e-06
org-cite-try-load-processor                              25          0.00025       1e-05
org-setup-filling                                        25          0.0002120000  8.480...e-06
org-babel-hide-all-hashes                                25          0.0002000000  8.000...e-06
org-persist-load                                         25          0.0001800000  7.200...e-06
org-cite-get-processor                                   25          0.0001770000  7.080...e-06
org-find-invisible-foreground                            25          0.00017       6.8e-06
org-update-radio-target-regexp                           25          0.0001390000  5.560...e-06
org-persist-read                                         25          0.0001170000  4.68e-06
org-assign-fast-keys                                     25          8.800...e-05  3.520...e-06
org-extract-log-state-settings                           50          7.699...e-05  1.539...e-06
org-fold-core--isearch-setup                             25          6.300...e-05  2.520...e-06
org-setup-comments-handling                              25          5.500...e-05  2.200...e-06
org-macro--counter-initialize                            25          4.900...e-05  1.960...e-06
org-macro--set-templates                                 25          4.000...e-05  1.600...e-06
org-agenda-files                                         25          3.599...e-05  1.439...e-06
org-compute-latex-and-related-regexp                     25          3.500...e-05  1.400...e-06
org-load-modules-maybe                                   25          3.4e-05       1.36e-06
org-element-restriction                                  25          3.4e-05       1.36e-06
org-delete-all                                           25          2.900...e-05  1.160...e-06
org-element-parse-secondary-string                       25          2.200...e-05  8.800...e-07
org-babel-result-hide-spec                               25          2.000...e-05  8.000...e-07
org-tag-alist-to-groups                                  25          2.000...e-05  8.000...e-07
org--tag-add-to-alist                                    25          1.800...e-05  7.200...e-07
</code></pre>
<h4>with <code>org-roam-with-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-org-roam-with-file                                25          0.297846      0.01191384
org-mode                                                 25          0.0663639999  0.00265456
org-macro-initialize-templates                           25          0.0414050000  0.0016562000
org-macro--counter-initialize                            25          0.03567       0.0014268
org-fold-initialize                                      25          0.0099350000  0.0003974000
org-fold-core-initialize                                 25          0.009818      0.00039272
org-fold-core-add-folding-spec                           125         0.0091620000  7.329...e-05
org-element-cache-reset                                  25          0.006497      0.00025988
org-fold-core--property-symbol-get-create                1125        0.0060750000  5.400...e-06
org-persist-register                                     50          0.0057070000  0.0001141400
org-persist--get-collection                              75          0.0053299999  7.106...e-05
org-persist--normalize-associated                        100         0.0043460000  4.346...e-05
org-set-regexps-and-options                              25          0.002475      9.900...e-05
org-install-agenda-files-menu                            25          0.0017709999  7.083...e-05
org-fold-core-set-folding-spec-property                  1150        0.0017329999  1.506...e-06
org-collect-keywords                                     50          0.001583      3.166e-05
org--collect-keywords-1                                  50          0.0012859999  2.571...e-05
org-macro--collect-macros                                25          0.001171      4.684e-05
org-make-options-regexp                                  50          0.0009220000  1.844...e-05
org-fold-core-get-folding-spec-from-alias                2250        0.0008730000  3.880...e-07
org-set-font-lock-defaults                               25          0.0005250000  2.100...e-05
org-persist--find-index                                  75          0.000432      5.76e-06
org-element--cache-setup-change-functions                25          0.0004260000  1.704...e-05
org-macro--find-keyword-value                            100         0.0003990000  3.990...e-06
org--set-faces-extend                                    50          0.0002879999  5.759...e-06
org-macro--find-date                                     25          0.000267      1.068e-05
org-setup-filling                                        25          0.0002500000  1.000...e-05
org-persist--normalize-container                         250         0.0002469999  9.879...e-07
org-cite-try-load-processor                              25          0.0002300000  9.200...e-06
org-find-invisible-foreground                            25          0.0001780000  7.120...e-06
org-cite-get-processor                                   25          0.0001760000  7.040...e-06
org-persist-load                                         25          0.000171      6.840...e-06
org-update-radio-target-regexp                           25          0.000143      5.72e-06
org-persist-read                                         25          0.0001130000  4.520...e-06
org-assign-fast-keys                                     25          8.600...e-05  3.440...e-06
org-extract-log-state-settings                           50          7.599...e-05  1.519...e-06
org-setup-comments-handling                              25          6.100...e-05  2.440...e-06
org-fold-core--isearch-setup                             25          5.700...e-05  2.28e-06
org-roam-with-file                                       25          5.400...e-05  2.160...e-06
org-macro--set-templates                                 25          4.300...e-05  1.720...e-06
org-agenda-files                                         25          4.100...e-05  1.640...e-06
org-compute-latex-and-related-regexp                     25          4.000...e-05  1.600...e-06
org-element-restriction                                  25          3.500...e-05  1.400...e-06
org-load-modules-maybe                                   25          3.200...e-05  1.280...e-06
org-delete-all                                           25          3.100...e-05  1.240...e-06
org-element-parse-secondary-string                       25          2.300...e-05  9.200...e-07
org-tag-alist-to-groups                                  25          1.900...e-05  7.600...e-07
org--tag-add-to-alist                                    25          1.200...e-05  4.800...e-07
</code></pre>
<h4>With <code>with-plain-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-plain-file                                   25          0.214249      0.00856996
</code></pre>
<h3>Run 3</h3>
<h4>With <code>with-current-buffer</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-current-buffer                               25          0.358344      0.01433376
org-roam-db-autosync--setup-file-h                       25          0.0754349999  0.0030173999
org-roam-file-p                                          25          0.075358      0.0030143199
org-roam-descendant-of-p                                 25          0.0742949999  0.0029717999
org-mode                                                 25          0.0468290000  0.0018731600
org-fold-initialize                                      25          0.0098470000  0.0003938800
org-fold-core-initialize                                 25          0.0097399999  0.0003895999
org-fold-core-add-folding-spec                           125         0.008941      7.1528e-05
org-element-cache-reset                                  25          0.0064449999  0.0002578
org-fold-core--property-symbol-get-create                1200        0.0060140000  5.011...e-06
org-persist-register                                     50          0.0056399999  0.0001127999
org-macro-initialize-templates                           25          0.00553       0.0002212
org-persist--get-collection                              75          0.0052869999  7.049...e-05
org-persist--normalize-associated                        100         0.0043050000  4.305...e-05
org-set-regexps-and-options                              25          0.0023629999  9.451...e-05
org-install-agenda-files-menu                            25          0.0017250000  6.900...e-05
org-fold-core-set-folding-spec-property                  1150        0.0016719999  1.453...e-06
org-collect-keywords                                     50          0.0014929999  2.985...e-05
org--collect-keywords-1                                  50          0.0012090000  2.418...e-05
org-macro--collect-macros                                25          0.001072      4.288e-05
org-fold-core-get-folding-spec-from-alias                2400        0.0008980000  3.741...e-07
org-make-options-regexp                                  50          0.0008630000  1.726...e-05
org-cycle-set-startup-visibility                         25          0.0008450000  3.380...e-05
org-fold-show-all                                        25          0.0007689999  3.075...e-05
org-fold-region                                          75          0.0006370000  8.493...e-06
org-set-font-lock-defaults                               25          0.0005360000  2.144...e-05
org-fold-core-region                                     75          0.0005210000  6.946...e-06
org-element--cache-setup-change-functions                25          0.0004589999  1.835...e-05
org-persist--find-index                                  75          0.0004320000  5.760...e-06
org-macro--find-keyword-value                            100         0.0003720000  3.720...e-06
org--set-faces-extend                                    50          0.0002739999  5.479...e-06
org-persist--normalize-container                         250         0.0002549999  1.019...e-06
org-cite-try-load-processor                              25          0.000252      1.008e-05
org-macro--find-date                                     25          0.0002400000  9.600...e-06
org-setup-filling                                        25          0.0002030000  8.120...e-06
org-babel-hide-all-hashes                                25          0.0001970000  7.880...e-06
org-cite-get-processor                                   25          0.0001860000  7.440...e-06
org-find-invisible-foreground                            25          0.0001790000  7.160...e-06
org-persist-load                                         25          0.0001760000  7.040...e-06
org-update-radio-target-regexp                           25          0.0001390000  5.560...e-06
org-persist-read                                         25          0.0001080000  4.320...e-06
org-roam--file-name-extension                            25          8.300...e-05  3.320...e-06
org-extract-log-state-settings                           50          8.299...e-05  1.659...e-06
org-assign-fast-keys                                     25          8.200...e-05  3.280...e-06
org-setup-comments-handling                              25          5.700...e-05  2.28e-06
org-fold-core--isearch-setup                             25          5.600...e-05  2.240...e-06
org-macro--set-templates                                 25          4.600...e-05  1.840...e-06
org-macro--counter-initialize                            25          4.5e-05       1.800...e-06
org-compute-latex-and-related-regexp                     25          3.899...e-05  1.559...e-06
org-element-restriction                                  25          3.800...e-05  1.520...e-06
org-agenda-files                                         25          3.7e-05       1.48e-06
org-load-modules-maybe                                   25          3.000...e-05  1.200...e-06
org-delete-all                                           25          2.900...e-05  1.160...e-06
org-babel-result-hide-spec                               25          2.400...e-05  9.600...e-07
org-element-parse-secondary-string                       25          2.400...e-05  9.600...e-07
org--tag-add-to-alist                                    25          1.900...e-05  7.600...e-07
org-tag-alist-to-groups                                  25          1.600...e-05  6.400...e-07
</code></pre>
<h4>with <code>org-roam-with-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-org-roam-with-file                                25          0.3011910000  0.0120476400
org-mode                                                 25          0.065139      0.0026055600
org-macro-initialize-templates                           25          0.0411049999  0.0016441999
org-collect-keywords                                     50          0.036973      0.0007394599
org--collect-keywords-1                                  50          0.0366959999  0.0007339199
org-macro--collect-macros                                25          0.036578      0.00146312
org-make-options-regexp                                  50          0.036341      0.00072682
org-fold-initialize                                      25          0.0099750000  0.0003990000
org-fold-core-initialize                                 25          0.0098709999  0.0003948399
org-fold-core-add-folding-spec                           125         0.0092929999  7.434...e-05
org-element-cache-reset                                  25          0.006196      0.00024784
org-fold-core--property-symbol-get-create                1125        0.0061050000  5.426...e-06
org-persist-register                                     50          0.0055499999  0.0001109999
org-persist--get-collection                              75          0.0052079999  6.943...e-05
org-persist--normalize-associated                        100         0.0042200000  4.220...e-05
org-set-regexps-and-options                              25          0.0023600000  9.440...e-05
org-fold-core-set-folding-spec-property                  1150        0.0017279999  1.502...e-06
org-install-agenda-files-menu                            25          0.00158       6.32e-05
org-fold-core-get-folding-spec-from-alias                2250        0.0008660000  3.848...e-07
org-set-font-lock-defaults                               25          0.0005090000  2.036...e-05
org-persist--find-index                                  75          0.0004350000  5.8e-06
org-macro--find-keyword-value                            100         0.0003630000  3.630...e-06
org-element--cache-setup-change-functions                25          0.0003070000  1.228...e-05
org-macro--find-date                                     25          0.000266      1.064e-05
org--set-faces-extend                                    50          0.000264      5.28e-06
org-persist--normalize-container                         250         0.0002469999  9.879...e-07
org-cite-try-load-processor                              25          0.000228      9.12e-06
org-setup-filling                                        25          0.0001930000  7.72e-06
org-persist-load                                         25          0.0001780000  7.120...e-06
org-cite-get-processor                                   25          0.0001640000  6.560...e-06
org-find-invisible-foreground                            25          0.0001610000  6.440...e-06
org-update-radio-target-regexp                           25          0.00014       5.6e-06
org-persist-read                                         25          0.0001130000  4.520...e-06
org-assign-fast-keys                                     25          8.1e-05       3.240...e-06
org-extract-log-state-settings                           50          7.199...e-05  1.439...e-06
org-setup-comments-handling                              25          6.1e-05       2.44e-06
org-fold-core--isearch-setup                             25          5.200...e-05  2.080...e-06
org-roam-with-file                                       25          4.700...e-05  1.880...e-06
org-compute-latex-and-related-regexp                     25          4.499...e-05  1.8e-06
org-macro--set-templates                                 25          4.400...e-05  1.760...e-06
org-macro--counter-initialize                            25          4.100...e-05  1.640...e-06
org-element-restriction                                  25          3.400...e-05  1.360...e-06
org-agenda-files                                         25          3.200...e-05  1.280...e-06
org-element-parse-secondary-string                       25          2.800...e-05  1.120...e-06
org-load-modules-maybe                                   25          2.600...e-05  1.040...e-06
org-delete-all                                           25          2.300...e-05  9.200...e-07
org--tag-add-to-alist                                    25          1.900...e-05  7.600...e-07
org-tag-alist-to-groups                                  25          1.500...e-05  6.000...e-07
</code></pre>
<h4>With <code>with-plain-file</code></h4>
<pre><code class="hljs language-csv">  Function Name                                          Call Count  Elapsed Time  Average Time
--test-with-plain-file                                   25          0.2157019999  0.00862808
</code></pre>
<h2>Summery from the <code>emacs -Q</code> profiles</h2>
<table class="table-auto">
 <colgroup><col>
 <col>
 </colgroup><tbody><tr>
  <td class="border border-slate-600 p-2" rowspan="2">Functions</td>
  <td class="border border-slate-600" colspan="4">Org version 9.5.5-g8cc821</td>
  <td class="border border-slate-600" colspan="4">Org version 9.5.4-g5a6442</td>
 </tr>
 <tr>
  <td class="border border-slate-600 p-2" >Run1</td>
  <td class="border border-slate-600 p-2" >Run2</td>
  <td class="border border-slate-600 p-2" >Run3</td>
  <td class="border border-slate-600 p-2" >Avg</td>
  <td class="border border-slate-600 p-2" >Run1</td>
  <td class="border border-slate-600 p-2" >Run2</td>
  <td class="border border-slate-600 p-2" >Run3</td>
  <td class="border border-slate-600 p-2" >Avg</td>
 </tr>
 <tr>
  <td class="border border-slate-600 p-2" >test-with-current-buffer</td>
  <td class="border border-slate-600 p-2" >0.0141548</td>
  <td class="border border-slate-600 p-2" >0.01415752</td>
  <td class="border border-slate-600 p-2" >0.0150422</td>
  <td class="border border-slate-600 p-2" >0.014451507</td>
  <td class="border border-slate-600 p-2" >0.01387448</td>
  <td class="border border-slate-600 p-2" >0.0147026</td>
  <td class="border border-slate-600 p-2" >0.01433376</td>
  <td class="border border-slate-600 p-2" >0.014303613</td>
 </tr>
 <tr>
  <td class="border border-slate-600 p-2" height="20" >test-org-roam-with-file</td>
  <td class="border border-slate-600 p-2" >0.01293492</td>
  <td class="border border-slate-600 p-2" >0.01199168</td>
  <td class="border border-slate-600 p-2" >0.01381696</td>
  <td class="border border-slate-600 p-2" >0.01291452</td>
  <td class="border border-slate-600 p-2" >0.01209968</td>
  <td class="border border-slate-600 p-2" >0.01191384</td>
  <td class="border border-slate-600 p-2" >0.01204764</td>
  <td class="border border-slate-600 p-2" >0.012020387</td>
 </tr>
 <tr>
  <td class="border border-slate-600 p-2" height="20" >test-with-plain-file</td>
  <td class="border border-slate-600 p-2" >0.00915172</td>
  <td class="border border-slate-600 p-2" >0.00927128</td>
  <td class="border border-slate-600 p-2" >0.00839904</td>
  <td class="border border-slate-600 p-2" >0.00894068</td>
  <td class="border border-slate-600 p-2" >0.00762304</td>
  <td class="border border-slate-600 p-2" >0.00856996</td>
  <td class="border border-slate-600 p-2" >0.00862808</td>
  <td class="border border-slate-600 p-2" >0.008273693</td>
 </tr>
</tbody></table>
</div><div class="m-4 border-t-4 border-slate-400/25"></div><giscus-widget id="comments" repo="ahmed-shariff/ahmed-shariff.github.io" repoid="MDEwOlJlcG9zaXRvcnkxMjU3MDU3Nzc=" category="Announcements" categoryid="DIC_kwDOB34eMc4COpxh" mapping="pathname" reactionsenabled="1" emitmetadata="0" inputposition="top" theme="light" lang="en" loading="lazy"></giscus-widget></div></main><div class="fixed bottom-4 right-4 drop-shadow-lg z-50 shadow-gray-900"><button><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="fill-sky-400 fill-gray-900 rounded-full bg-slate-600 hover:bg-slate-500" height="60" width="60" xmlns="http://www.w3.org/2000/svg"><path d="M256 464c114.9 0 208-93.1 208-208S370.9 48 256 48 48 141.1 48 256s93.1 208 208 208zm0-244.5l-81.1 81.9c-7.5 7.5-19.8 7.5-27.3 0s-7.5-19.8 0-27.3l95.7-95.4c7.3-7.3 19.1-7.5 26.6-.6l94.3 94c3.8 3.8 5.7 8.7 5.7 13.7 0 4.9-1.9 9.9-5.6 13.6-7.5 7.5-19.7 7.6-27.3 0l-81-79.9z"></path></svg></button></div><footer class="bg-gray-800 mt-8 py-4 text-gray-300 drop-shadow-lg shadow-gray-900"><div class="container mx-auto flex justify-center text-sm">© 2022 Shariff Faleel</div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"2022-09-16-profiling_loading_org_files","frontmatter":{"layout":"post","comments":true,"title":"Profiling file loading times for org mode","tags":["emacs","org"],"tagline":"The loading times of files was starting to become an issue as I started switching to the 'one file per note` approach in my org-roam database. Documenting some profiling I did to see what I can do about it."},"content":"\nThis is an extension of the discussion started in [`org-ql`s issues](https://github.com/alphapapa/org-ql/issues/303).\n\nRecently I had broken up some of my very large org files that hosted alot of my notes, specially the org file accompanying the bibliography database. It was getting a bit wild to manage a file that had more that 40k lines and performance also was taking a hit. \nI loved `org-roam` using the sqlite back-end to speedup working with a large database of org files, while also giving the end-users access to this back-end.\nBefore `org-roam` I was heavily using `org-brain`. I really liked how the relationships were tucked into property drawers. Since `org-roam` started track links in the property drawers, I had started completely relying on `org-roam`.\n\nAfter breaking apart my large files, all was good and well except for it breaking my `org-ql` setup.\nI was using `org-ql` alot to quickly query across my database. It's a very cool package that uses the `org-agenda` buffers to display queries. \nWhile `org-roam`s `org-roam-buffer` did some very interesting things, it didn't have the flexibility that `org-ql` afforded when I wanted to try and search the database based on the links between nodes.\nSee, `org-ql` is build on top of the `org-element` API and `org-agenda`. They depend on the corresponding org files being open. Whereas `org-roam` caches all the necessary data in the sqlite database and open the org files only when needed, which is what allows it to be fast when searching through large number of files.\nWhereas when trying to run an `org-ql` query on the same database with a large number of files, it has to open all the files in the database. So I started writing a simple front-end for `org-roam` with `org-ql`, where the agenda buffer entries are built from the result of a query to `org-roam`s database, then `org-ql` would do it's thing. This way, all files are not being opened. Instead, only the files pertaining the query are being opened, cutting down the number of files that needs to be opened by a very large margin. \n\nWhile this provides an interface that's usable, the performance was still an issue as it take atleast a few seconds even if the result only had a few dozen nodes. The bottleneck turned out to being opening the files and getting the markers which are needed for `org-agenda` to work. Following the comments on the `org-ql` [issue](https://github.com/alphapapa/org-ql/issues/303), I profiled a few different options and see what happens. This post is simply a documentation of this.\n\nAll test run on emacs version:\n```sh\nGNU Emacs 28.1 (build 2, x86_64-w64-mingw32) of 2022-04-21\n```\n\n## Testing the with roam-nodes\nI had three different approaches to opening a file I am testing:\n- The simplest solution using `with-current-buffer` and `find-file-noselect`. \n- Using `org-roam-with-file`\n- A slightly modified version of `org-roam-with-file` where `org-mode` is not loaded. This was for reference more than anything else.\n```lisp\n(defmacro with-plain-file (file keep-buf-p \u0026rest body)\n  \"Same as `org-roam-with-file', but doesn't start `org-roam'.\"\n  (declare (indent 2) (debug t))\n  `(let* (new-buf\n          (auto-mode-alist nil)\n          (find-file-hook nil)\n          (buf (or\n                (and (not ,file)\n                     (current-buffer)) ;If FILE is nil, use current buffer\n                (find-buffer-visiting ,file) ; If FILE is already visited, find buffer\n                (progn\n                  (setq new-buf t)\n                  (find-file-noselect ,file)))) ; Else, visit FILE and return buffer\n          res)\n     (with-current-buffer buf\n       (setq res (progn ,@body))\n       (unless (and new-buf (not ,keep-buf-p))\n         (save-buffer)))\n     (if (and new-buf (not ,keep-buf-p))\n         (when (find-buffer-visiting ,file)\n           (kill-buffer (find-buffer-visiting ,file))))\n     res))\n```\n\n\nI started with loading a bunch of random nodes from different files and profile using `elp` and 55 random nodes (same nodes used on all tests):\n```lisp\n(defun run-elp (func sources)\n  \"Instrument org and FUNC and iterate on SOURCES with FUNC.\nFUNC is a sumbol representing a function that takes one parameter.\nSOURCES is a list of element that will be processed by FUNC\"\n  (elp-instrument-package \"org\")\n  (elp-instrument-function func)\n  (elp-reset-all)\n  (mapcar func sources)\n  (elp-results))\n```\n\n### Test with `with-current-buffer`\n\n```lisp\n(defun org-roam-ql--get-file-marker (node)\n  (with-current-buffer (find-file-noselect (org-roam-node-file node))\n    (goto-char (org-roam-node-point node))\n    (point-marker)))\n\n(let ((nodes (--map (org-roam-node-from-id it) random-node-ids)))\n  (--map (when-let (buf (find-buffer-visiting (org-roam-node-file it))) (kill-buffer buf)) nodes)\n  (run-elp 'org-roam-ql--get-file-marker nodes))\n```\n\nResults: \n\n```csv\n  Function Name                                                    Call Count  Elapsed Time  Average Time\norg-roam-ql--get-file-marker                                       55          49.118194999  0.8930580909\norg-mode                                                           55          1.94798       0.0354178181\norg-display-inline-images                                          55          0.169515      0.0030820909\norg-fold-core-fontify-region                                       55          0.1608879999  0.0029252363\norg-activate-links                                                 525         0.1235360000  0.0002353066\norg-activate-links--text-properties                                525         0.1225479999  0.0002334247\norg-ref-cite-activate                                              111         0.0980770000  0.0008835765\norg-ref-valid-keys                                                 111         0.09223       0.0008309009\norg-install-agenda-files-menu                                      55          0.0870710000  0.0015831090\norg-agenda-files                                                   55          0.071968      0.0013085090\norg-element-cache-reset                                            55          0.0703109999  0.0012783818\norg-cycle-set-startup-visibility                                   55          0.064626      0.0011750181\norg-fold--hide-drawers                                             110         0.0564499999  0.0005131818\norg-cycle-hide-drawers                                             55          0.0563539999  0.0010246181\norg-fold--hide-drawers--text-properties                            110         0.0561990000  0.0005109000\norg-fold-initialize                                                55          0.0515590000  0.0009374363\norg-element-at-point                                               102         0.0514149999  0.0005040686\norg-fold-core-initialize                                           55          0.051243      0.0009316909\norg-element--parse-to                                              104         0.0491009999  0.0004721249\norg-element--cache-setup-change-functions                          55          0.035294      0.0006417090\norg-persist-register                                               110         0.0338739999  0.0003079454\norg-element--current-element                                       296         0.0335950000  0.0001134966\norg-persist-load                                                   55          0.0232400000  0.0004225454\norg-fold-core-add-folding-spec                                     275         0.0232329999  8.448...e-05\norg-persist-read                                                   55          0.0230699999  0.0004194545\norg-persist--get-collection                                        165         0.019464      0.0001179636\norg-persist--normalize-associated                                  220         0.0168399999  7.654...e-05\norg-macro-initialize-templates                                     55          0.016255      0.0002955454\norg-fold-core--property-symbol-get-create                          3559        0.0161759999  4.545...e-06\norg-get-limited-outline-regexp                                     393         0.0124609999  3.170...e-05\norg-element-headline-parser                                        96          0.0120459999  0.0001254791\norg-set-regexps-and-options                                        55          0.010741      0.0001952909\norg-element--cache-persist-before-read                             110         0.0098299999  8.936...e-05\norg-collect-keywords                                               110         0.0061729999  5.611...e-05\norg-element--cache-put                                             351         0.005797      1.651...e-05\norg-element--get-node-properties                                   151         0.0057880000  3.833...e-05\norg-macro--collect-macros                                          55          0.0056149999  0.0001020909\norg-fold-core-region                                               378         0.0054469999  1.441...e-05\norg--collect-keywords-1                                            110         0.0053270000  4.842...e-05\norg-cycle-content                                                  55          0.0047950000  8.718...e-05\norg-cycle-content--text-properties                                 55          0.0046260000  8.410...e-05\norg-fold-core-set-folding-spec-property                            2805        0.0042610000  1.519...e-06\norg-element-org-data-parser                                        55          0.0034479999  6.269...e-05\norg-link-get-parameter                                             2821        0.0033830000  1.199...e-06\norg-element-link-parser                                            471         0.0031629999  6.715...e-06\norg-macro--find-keyword-value                                      220         0.0030170000  1.371...e-05\norg-do-emphasis-faces                                              55          0.0029490000  5.361...e-05\norg-fold-core-get-folding-spec-from-alias                          7009        0.0029420000  4.197...e-07\norg-fold-hide-drawer-toggle                                        101         0.0029130000  2.884...e-05\norg-fold--hide-wrapper-toggle                                      101         0.0026870000  2.660...e-05\norg-set-font-lock-defaults                                         55          0.002522      4.585...e-05\norg-make-options-regexp                                            110         0.0025150000  2.286...e-05\norg-setup-filling                                                  55          0.002482      4.512...e-05\norg-element--cache-persist-after-read                              110         0.0022579999  2.052...e-05\norg-fontify-drawers                                                338         0.0020610000  6.097...e-06\norg-element-section-parser                                         95          0.00198       2.084...e-05\norg-fold-core-get-folding-spec                                     211         0.0019749999  9.360...e-06\norg-element--cache-compare                                         1626        0.0016389999  1.007...e-06\norg-unfontify-region                                               55          0.001597      2.903...e-05\norg-element-property-drawer-parser                                 94          0.0015959999  1.697...e-05\norg-persist-load:elisp                                             110         0.0015889999  1.444...e-05\norg-fontify-meta-lines-and-blocks                                  55          0.0014579999  2.650...e-05\norg-persist--find-index                                            220         0.0014290000  6.495...e-06\norg-ref-find-bibliography                                          111         0.0013189999  1.188...e-05\norg-fontify-meta-lines-and-blocks-1                                55          0.0013110000  2.383...e-05\norg-ref-org-menu                                                   6           0.001288      0.0002146666\norg-cycle-hide-archived-subtrees                                   55          0.001217      2.212...e-05\norg-fold-folded-p                                                  101         0.0012159999  1.203...e-05\norg-cite-activate                                                  55          0.0011830000  2.150...e-05\norg--set-faces-extend                                              110         0.0011719999  1.065...e-05\norg-element--cache-verify-element                                  102         0.001169      1.146...e-05\norg-cite-get-processor                                             165         0.0010949999  6.636...e-06\norg-macro--find-date                                               55          0.0010780000  1.960...e-05\norg-fold-hide-archived-subtrees                                    55          0.001039      1.889...e-05\norg-fold-show-all--text-properties                                 55          0.0009819999  1.785...e-05\norg-element-context                                                1           0.000954      0.000954\norg-fold-core-folded-p                                             101         0.0009459999  9.366...e-06\norg-transclusion-fontify-meta-lines-and-blocks                     55          0.0009400000  1.709...e-05\norg-cycle-show-empty-lines                                         55          0.0008979999  1.632...e-05\norg-fontify-inline-src-blocks                                      55          0.0007900000  1.436...e-05\norg-element--cache-active-p                                        1318        0.0007860000  5.963...e-07\norg-persist--normalize-container                                   660         0.0007540000  1.142...e-06\norg-cycle-set-visibility-according-to-property                     55          0.0007300000  1.327...e-05\norg-cite-try-load-processor                                        55          0.0006920000  1.258...e-05\norg-extract-log-state-settings                                     495         0.0006870000  1.387...e-06\norg-element--cache-find                                            102         0.0006750000  6.617...e-06\norg-fontify-inline-src-blocks-1                                    55          0.0006400000  1.163...e-05\norg-activate-tags                                                  55          0.000629      1.143...e-05\norg-activate-footnote-links                                        55          0.0005870000  1.067...e-05\norg-cite-processor-has-capability-p                                55          0.0005860000  1.065...e-05\norg-font-lock-add-priority-faces                                   55          0.0005580000  1.014...e-05\norg-element--cache-sync                                            102         0.0005279999  5.176...e-06\norg-fold-core-next-folding-state-change                            55          0.000523      9.509...e-06\norg-element-property                                               1716        0.0004930000  2.872...e-07\norg-find-invisible-foreground                                      55          0.0004899999  8.909...e-06\norg-update-radio-target-regexp                                     55          0.0004709999  8.563...e-06\norg-activate-dates                                                 74          0.0004420000  5.972...e-06\norg-element--get-global-node-properties                            55          0.0004289999  7.8e-06\norg-footnote-next-reference-or-definition                          55          0.0004269999  7.763...e-06\norg-fold-hide-drawer-all                                           55          0.0004190000  7.618...e-06\norg-file-menu-entry                                                1045        0.0003530000  3.377...e-07\norg-at-comment-p                                                   110         0.0003450000  3.136...e-06\norg-remove-flyspell-overlays-in                                    772         0.0003380000  4.378...e-07\norg-activate-code                                                  55          0.0003290000  5.981...e-06\norg-babel-hide-all-hashes                                          6           0.000317      5.283...e-05\norg-delete-all                                                     110         0.0003099999  2.818...e-06\norg-do-latex-and-related                                           55          0.0002539999  4.618...e-06\norg-element--get-time-properties                                   96          0.0002169999  2.260...e-06\norg-get-level-face                                                 318         0.0002029999  6.383...e-07\norg-remove-keyword-keys                                            110         0.0001999999  1.818...e-06\norg-ref-cite-version                                               111         0.0001989999  1.792...e-06\norg-bullets-mode                                                   6           0.0001970000  3.283...e-05\norg-skip-whitespace                                                353         0.0001879999  5.325...e-07\norg-setup-comments-handling                                        55          0.0001849999  3.363...e-06\norg-transclusion-font-lock-set                                     55          0.0001769999  3.218...e-06\norg-macro--counter-initialize                                      55          0.0001759999  3.199...e-06\norg-element--collect-affiliated-keywords                           10          0.00017       1.7e-05\norg-fold-core--isearch-setup                                       55          0.0001629999  2.963...e-06\norg-knuth-hash                                                     102         0.0001439999  1.411...e-06\norg-element-drawer-parser                                          9           0.000141      1.566...e-05\norg-re-property                                                    55          0.0001389999  2.527...e-06\norg-fontify-macros                                                 55          0.0001319999  2.399...e-06\norg-element-timestamp-parser                                       6           0.0001300000  2.166...e-05\norg-compute-latex-and-related-regexp                               55          0.0001139999  2.072...e-06\norg-macro--set-templates                                           55          0.0001139999  2.072...e-06\norg-element-planning-parser                                        3           0.000112      3.733...e-05\norg-assign-fast-keys                                               55          0.0001119999  2.036...e-06\norg-load-modules-maybe                                             55          0.0001049999  1.909...e-06\norg-string-nw-p                                                    55          0.0001029999  1.872...e-06\norg-element-restriction                                            55          9.899...e-05  1.799...e-06\norg-fold-core--check-spec                                          55          9.799...e-05  1.781...e-06\norg-tag-alist-to-groups                                            55          8.899...e-05  1.618...e-06\norg-remove-inline-images                                           55          7.899...e-05  1.436...e-06\norg-reduced-level                                                  96          7.299...e-05  7.604...e-07\norg-get-todo-face                                                  18          7.2e-05       4e-06\norg-remove-font-lock-display-properties                            55          7.199...e-05  1.309...e-06\norg-element-type                                                   202         6.399...e-05  3.168...e-07\norg-file-name-concat                                               55          5.899...e-05  1.072...e-06\norg-element--object-lex                                            1           5.7e-05       5.7e-05\norg-element-parse-secondary-string                                 55          5.499...e-05  9.999...e-07\norg-font-lock-hook                                                 55          5.199...e-05  9.454...e-07\norg-activate-target-links                                          55          4.499...e-05  8.181...e-07\norg-fontify-entities                                               55          3.899...e-05  7.090...e-07\norg--tag-add-to-alist                                              55          3.5e-05       6.363...e-07\norg-raise-scripts                                                  55          3.000...e-05  5.454...e-07\norg-parse-time-string                                              6           2.7e-05       4.5e-06\norg-fold-core-update-optimisation                                  55          2.500...e-05  4.545...e-07\norg-font-lock-add-tag-faces                                        55          2.300...e-05  4.181...e-07\norg-eldoc-load                                                     6           1.9e-05       3.166...e-06\norg-element-paragraph-parser                                       1           1.3e-05       1.3e-05\norg-babel-result-hide-spec                                         6           1.099...e-05  1.833...e-06\norg-bullets--fontify-buffer                                        6           9.999...e-06  1.666...e-06\norg-link-expand-abbrev                                             2           8e-06         4e-06\norg-face-from-face-or-color                                        19          4.999...e-06  2.631...e-07\norg-link-unescape                                                  2           4e-06         2e-06\norg-get-priority-face                                              1           3e-06         3e-06\norg-item-re                                                        1           2e-06         2e-06\norg-element-lineage                                                1           1e-06         1e-06\n```\n\n### Test with `org-roam-with-file`\n\n```lisp\n(defun org-roam-ql--get-file-marker (node)\n  (org-roam-with-file (org-roam-node-file node) t\n    (goto-char (org-roam-node-point node))\n    (point-marker)))\n\n(let ((nodes (--map (org-roam-node-from-id it) random-node-ids)))\n  (--map (when-let (buf (find-buffer-visiting (org-roam-node-file it))) (kill-buffer buf)) nodes)\n  (run-elp 'org-roam-ql--get-file-marker nodes))\n```\n\nResults: \n\n```csv\n  Function Name                                                    Call Count  Elapsed Time  Average Time\norg-roam-ql--get-file-marker                                       55          43.752767999  0.7955048727\norg-mode                                                           55          0.272921      0.0049622000\norg-element-cache-reset                                            55          0.0759590000  0.0013810727\norg-fold-initialize                                                55          0.0505179999  0.0009185090\norg-fold-core-initialize                                           55          0.050176      0.0009122909\norg-persist-register                                               110         0.0381199999  0.0003465454\norg-element--cache-setup-change-functions                          55          0.0366800000  0.0006669090\norg-persist-load                                                   55          0.0242390000  0.0004407090\norg-persist-read                                                   55          0.0240559999  0.0004373818\norg-fold-core-add-folding-spec                                     275         0.0226350000  8.230...e-05\norg-persist--get-collection                                        165         0.0225730000  0.0001368060\norg-persist--normalize-associated                                  220         0.0197909999  8.995...e-05\norg-macro-initialize-templates                                     55          0.015801      0.0002872909\norg-fold-core--property-symbol-get-create                          2475        0.0150779999  6.092...e-06\norg-install-agenda-files-menu                                      55          0.0127110000  0.0002311090\norg-set-regexps-and-options                                        55          0.0121209999  0.0002203818\norg-element--cache-persist-before-read                             110         0.0099919999  9.083...e-05\norg-collect-keywords                                               110         0.007386      6.714...e-05\norg--collect-keywords-1                                            110         0.006386      5.805...e-05\norg-macro--collect-macros                                          55          0.00541       9.836...e-05\norg-fold-core-set-folding-spec-property                            2805        0.0042220000  1.505...e-06\norg-macro--find-keyword-value                                      220         0.0028549999  1.297...e-05\norg-set-font-lock-defaults                                         55          0.0025840000  4.698...e-05\norg-make-options-regexp                                            110         0.0025690000  2.335...e-05\norg-setup-filling                                                  55          0.00232       4.218...e-05\norg-element--cache-persist-after-read                              110         0.0021390000  1.944...e-05\norg-fold-core-get-folding-spec-from-alias                          4950        0.0021289999  4.301...e-07\norg-persist-load:elisp                                             110         0.0015319999  1.392...e-05\norg-persist--find-index                                            220         0.0014970000  6.804...e-06\norg--set-faces-extend                                              110         0.0012109999  1.100...e-05\norg-macro--find-date                                               55          0.0010879999  1.978...e-05\norg-persist--normalize-container                                   660         0.0008620000  1.306...e-06\norg-cite-try-load-processor                                        55          0.0007179999  1.305...e-05\norg-extract-log-state-settings                                     495         0.0006690000  1.351...e-06\norg-cite-get-processor                                             55          0.0005470000  9.945...e-06\norg-find-invisible-foreground                                      55          0.0005280000  9.600...e-06\norg-update-radio-target-regexp                                     55          0.000456      8.290...e-06\norg-delete-all                                                     110         0.0002979999  2.709...e-06\norg-remove-keyword-keys                                            110         0.0002189999  1.990...e-06\norg-transclusion-font-lock-set                                     55          0.0001929999  3.509...e-06\norg-fold-core--isearch-setup                                       55          0.0001829999  3.327...e-06\norg-setup-comments-handling                                        55          0.0001739999  3.163...e-06\norg-macro--counter-initialize                                      55          0.0001449999  2.636...e-06\norg-macro--set-templates                                           55          0.0001159999  2.109...e-06\norg-compute-latex-and-related-regexp                               55          0.0001149999  2.090...e-06\norg-assign-fast-keys                                               55          0.0001089999  1.981...e-06\norg-agenda-files                                                   55          0.0001079999  1.963...e-06\norg-element-restriction                                            55          0.0001069999  1.945...e-06\norg-load-modules-maybe                                             55          9.799...e-05  1.781...e-06\norg-tag-alist-to-groups                                            55          8.999...e-05  1.636...e-06\norg-file-name-concat                                               55          5.499...e-05  9.999...e-07\norg-element-parse-secondary-string                                 55          5.099...e-05  9.272...e-07\norg--tag-add-to-alist                                              55          2.900...e-05  5.272...e-07\n```\n\n### Test with `with-plain-file`\n\n```lisp\n(defun org-roam-ql--get-file-marker (node)\n  (with-plain-file (org-roam-node-file node) t\n    (goto-char (org-roam-node-point node))\n    (point-marker)))\n\n(let ((nodes (--map (org-roam-node-from-id it) random-node-ids)))\n  (--map (when-let (buf (find-buffer-visiting (org-roam-node-file it))) (kill-buffer buf)) nodes)\n  (run-elp 'org-roam-ql--get-file-marker nodes))\n```\n\nResults: \n\n```csv\n  Function Name                                                    Call Count  Elapsed Time  Average Time\norg-roam-ql--get-file-marker                                       55          28.741321999  0.5225694909\n```\n\n\n## Testing with `emacs -Q` (org version `9.5.4-g5a6442`)\n\nThe tests in the above as well this uses the following org version\n```sh\nOrg mode version 9.5.4 (9.5.4-g5a6442 @ ~/.emacs.d/straight/build/org/)\n```\n\nThe above tests were done with the all my setting running. So I also tested it out with `emacs -q`.\n\nI first run emacs with `-Q` with straight bootstrapped:\n```sh\nemacs -Q -l ~/.emacs.d/straight/repos/straight.el/bootstrap.el\n```\n\nThen run the following script:\n```lisp\n(straight-use-package 'org)\n(straight-use-package 'org-roam)\n\n(defun run-elp (func sources)\n  \"Instrument org and FUNC and iterate on SOURCES with FUNC.\nFUNC is a sumbol representing a function that takes one parameter.\nSOURCES is a list of element that will be processed by FUNC\"\n  (elp-instrument-package \"org\")\n  (elp-instrument-function func)\n  (elp-reset-all)\n  (mapcar func sources)\n  (elp-results))\n\n(defmacro with-plain-file (file keep-buf-p \u0026rest body)\n  \"Same as `org-roam-with-file', but doesn't start `org-roam'.\"\n  (declare (indent 2) (debug t))\n  `(let* (new-buf\n          (auto-mode-alist nil)\n          (find-file-hook nil)\n          (buf (or\n                (and (not ,file)\n                     (current-buffer)) ;If FILE is nil, use current buffer\n                (find-buffer-visiting ,file) ; If FILE is already visited, find buffer\n                (progn\n                  (setq new-buf t)\n                  (find-file-noselect ,file)))) ; Else, visit FILE and return buffer\n          res)\n     (with-current-buffer buf\n       (setq res (progn ,@body))\n       (unless (and new-buf (not ,keep-buf-p))\n         (save-buffer)))\n     (if (and new-buf (not ,keep-buf-p))\n         (when (find-buffer-visiting ,file)\n           (kill-buffer (find-buffer-visiting ,file))))\n     res))\n\n(defun test-org-load-files (func \u0026optional restart)\n  (let ((test-dir \"~/temp/org-mode-test/\")\n        files)\n    (message \"Tests running\")\n    (when (and (file-exists-p test-dir) restart)\n      (dolist (f (directory-files (file-truename test-dir))) (unless (member f '(\".\" \"..\")) (delete-file f)))\n      (delete-directory (file-truename test-dir) t))\n\n    (if (or restart (not (file-exists-p test-dir)))\n        (progn\n          (make-directory (file-truename test-dir))\n          ;; generating a bunch of file for testing\n          (dolist (num (number-sequence 1 25 1))\n            (let ((auto-mode-alist nil)\n                  (find-file-hook nil)\n                  (id (org-id-new))\n                  (f (file-truename (format \"~/temp/org-roam-test/test_%s.org\" num))))\n              (push f files)\n              (with-current-buffer (find-file-noselect f)\n                (erase-buffer)\n                (insert (format \"* This is the heading in file number %s\n  :PROPERTIES:\n  :ID:       %s\n  :TEST_PROP_1: %s\n  :TEST_PROP_2: id:%s\n  :END:\" num id num id))\n                (save-buffer)\n                (kill-buffer (find-buffer-visiting f))))))\n      (progn\n        (mapcar (lambda (f) (let ((f (find-buffer-visiting f)))\n                              (em f)\n                              (when f\n                                (kill-buffer f))))\n                (setq files (f-glob \"*.org\" test-dir)))))\n\n    (run-elp func files)\n    (with-current-buffer \"*ELP Profiling Results*\"\n      (write-file (format \"~/elp_results_%s\" func (format-time-string \"%Y-%m-%dT%H-%M-%S%-z\"))))))\n\n(defun --test-org-roam-with-file (f)\n  (org-roam-with-file f t\n    (goto-char 3)\n    (point-marker)))\n\n(defun --test-with-current-buffer (f)\n  (with-current-buffer (find-file-noselect f)\n    (goto-char 3)\n    (point-marker)))\n\n(defun --test-with-plain-file (f)\n  (with-plain-file f t\n    (goto-char 3)\n    (point-marker)))\n\n(setq org-roam-directory (file-truename \"~/temp/org-mode-test/\"))\n(setq org-roam-node-display-template (concat \"${title:*} \" (propertize \"${tags:10}\" 'face 'org-tag)))\n(org-roam-db-autosync-mode)\n\n(with-eval-after-load 'org-roam\n  ;; running twice to so that the first time around module loading won't effect times\n  (dolist (func '(--test-org-roam-with-file\n                  --test-with-current-buffer\n                  --test-with-plain-file))\n    (test-org-load-files func t))\n\n  (dolist (func '(--test-org-roam-with-file\n                  --test-with-current-buffer\n                  --test-with-plain-file))\n    (test-org-load-files func t)))\n```\n\nThe results are as follows:\n\n### Run 1:\n#### With `with-current-buffer`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-current-buffer                               25          0.3538700000  0.0141548000\norg-mode                                                 25          0.078992      0.00315968\norg-roam-db-autosync--setup-file-h                       25          0.0404749999  0.0016189999\norg-roam-file-p                                          25          0.0404000000  0.0016160000\norg-roam-descendant-of-p                                 25          0.039471      0.00157884\norg-set-regexps-and-options                              25          0.0356599999  0.0014263999\norg-collect-keywords                                     50          0.0348489999  0.0006969799\norg-fold-initialize                                      25          0.00966       0.0003864\norg-fold-core-initialize                                 25          0.009571      0.0003828399\norg-fold-core-add-folding-spec                           125         0.0088600000  7.088...e-05\norg-element-cache-reset                                  25          0.006279      0.00025116\norg-fold-core--property-symbol-get-create                1200        0.0058570000  4.880...e-06\norg-persist-register                                     50          0.005518      0.0001103600\norg-macro-initialize-templates                           25          0.005454      0.0002181599\norg-persist--get-collection                              75          0.0051669999  6.889...e-05\norg-persist--normalize-associated                        100         0.0042320000  4.232...e-05\norg-fold-core-set-folding-spec-property                  1275        0.0016609999  1.302...e-06\norg-install-agenda-files-menu                            25          0.0015780000  6.312e-05\norg--collect-keywords-1                                  50          0.0012510000  2.502...e-05\norg-macro--collect-macros                                25          0.00106       4.24e-05\norg-make-options-regexp                                  50          0.0008890000  1.778...e-05\norg-fold-core-get-folding-spec-from-alias                2400        0.0008710000  3.629...e-07\norg-cycle-set-startup-visibility                         25          0.0007679999  3.071...e-05\norg-fold-show-all--text-properties                       25          0.0007039999  2.815...e-05\norg-fold-core-region                                     75          0.0005510000  7.346...e-06\norg-set-font-lock-defaults                               25          0.0004940000  1.976...e-05\norg-element--cache-setup-change-functions                25          0.0004249999  1.699...e-05\norg-persist--find-index                                  75          0.0003999999  5.333...e-06\norg-macro--find-keyword-value                            100         0.0003710000  3.710...e-06\norg--set-faces-extend                                    50          0.000254      5.08e-06\norg-macro--find-date                                     25          0.000247      9.88e-06\norg-persist--normalize-container                         250         0.0002429999  9.719...e-07\norg-cite-try-load-processor                              25          0.0002270000  9.080...e-06\norg-babel-hide-all-hashes                                25          0.0002170000  8.680...e-06\norg-setup-filling                                        25          0.0001920000  7.680...e-06\norg-cite-get-processor                                   25          0.0001680000  6.720...e-06\norg-find-invisible-foreground                            25          0.0001590000  6.360...e-06\norg-persist-load                                         25          0.0001530000  6.120...e-06\norg-update-radio-target-regexp                           25          0.000132      5.28e-06\norg-persist-read                                         25          0.0001030000  4.120...e-06\norg-roam--file-name-extension                            25          8.300...e-05  3.320...e-06\norg-assign-fast-keys                                     25          7.9e-05       3.16e-06\norg-extract-log-state-settings                           50          7.799...e-05  1.559...e-06\norg-setup-comments-handling                              25          5.400...e-05  2.16e-06\norg-macro--counter-initialize                            25          4.900...e-05  1.960...e-06\norg-fold-core--isearch-setup                             25          4.700...e-05  1.880...e-06\norg-compute-latex-and-related-regexp                     25          4.2e-05       1.68e-06\norg-macro--set-templates                                 25          4.100...e-05  1.640...e-06\norg-element-restriction                                  25          3.3e-05       1.32e-06\norg-agenda-files                                         25          3.200...e-05  1.280...e-06\norg-load-modules-maybe                                   25          2.900...e-05  1.160...e-06\norg-delete-all                                           25          2.400...e-05  9.600...e-07\norg-element-parse-secondary-string                       25          2.300...e-05  9.200...e-07\norg-babel-result-hide-spec                               25          2.200...e-05  8.800...e-07\norg-tag-alist-to-groups                                  25          1.300...e-05  5.200...e-07\norg--tag-add-to-alist                                    25          1.200...e-05  4.800...e-07\n```\n\n#### with `org-roam-with-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-org-roam-with-file                                25          0.3233730000  0.0129349200\norg-mode                                                 25          0.070406      0.00281624\norg-fold-initialize                                      25          0.0493970000  0.0019758800\norg-fold-core-initialize                                 25          0.0493009999  0.0019720399\norg-fold-core-add-folding-spec                           125         0.0486619999  0.0003892959\norg-fold-core--property-symbol-get-create                1125        0.0450600000  4.005...e-05\norg-element-cache-reset                                  25          0.0068629999  0.00027452\norg-persist-register                                     50          0.006138      0.00012276\norg-macro-initialize-templates                           25          0.006024      0.00024096\norg-persist--get-collection                              75          0.0057329999  7.643...e-05\norg-persist--normalize-associated                        100         0.0046360000  4.636...e-05\norg-set-regexps-and-options                              25          0.0025940000  0.0001037600\norg-fold-core-set-folding-spec-property                  1275        0.0019359999  1.518...e-06\norg-collect-keywords                                     50          0.001671      3.342e-05\norg-install-agenda-files-menu                            25          0.0015079999  6.031...e-05\norg--collect-keywords-1                                  50          0.0013849999  2.769...e-05\norg-macro--collect-macros                                25          0.00117       4.68e-05\norg-fold-core-get-folding-spec-from-alias                2250        0.0010050000  4.466...e-07\norg-make-options-regexp                                  50          0.000976      1.952e-05\norg-set-font-lock-defaults                               25          0.0005629999  2.251...e-05\norg-persist--find-index                                  75          0.0004639999  6.186...e-06\norg-macro--find-keyword-value                            100         0.0004170000  4.170...e-06\norg-element--cache-setup-change-functions                25          0.000342      1.368...e-05\norg-persist--normalize-container                         250         0.0002679999  1.071...e-06\norg-macro--find-date                                     25          0.000261      1.044e-05\norg-cite-try-load-processor                              25          0.0002520000  1.008...e-05\norg--set-faces-extend                                    50          0.0002420000  4.84e-06\norg-setup-filling                                        25          0.0002040000  8.160...e-06\norg-cite-get-processor                                   25          0.0001850000  7.400...e-06\norg-persist-load                                         25          0.0001790000  7.160...e-06\norg-find-invisible-foreground                            25          0.0001580000  6.320...e-06\norg-update-radio-target-regexp                           25          0.0001490000  5.960...e-06\norg-persist-read                                         25          0.0001200000  4.800...e-06\norg-assign-fast-keys                                     25          9.000...e-05  3.600...e-06\norg-extract-log-state-settings                           50          8.199...e-05  1.639...e-06\norg-setup-comments-handling                              25          6.2e-05       2.48e-06\norg-macro--counter-initialize                            25          5.4e-05       2.16e-06\norg-fold-core--isearch-setup                             25          5.300...e-05  2.120...e-06\norg-compute-latex-and-related-regexp                     25          4.800...e-05  1.920...e-06\norg-roam-with-file                                       25          4.700...e-05  1.880...e-06\norg-macro--set-templates                                 25          4.400...e-05  1.760...e-06\norg-agenda-files                                         25          3.100...e-05  1.240...e-06\norg-load-modules-maybe                                   25          2.800...e-05  1.120...e-06\norg-element-restriction                                  25          2.700...e-05  1.080...e-06\norg-delete-all                                           25          2.100...e-05  8.400...e-07\norg-element-parse-secondary-string                       25          1.700...e-05  6.800...e-07\norg-tag-alist-to-groups                                  25          1.600...e-05  6.400...e-07\norg--tag-add-to-alist                                    25          1.400...e-05  5.600...e-07\n```\n\n#### With `with-plain-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-plain-file                                   25          0.2287930000  0.00915172\n```\n\n\n### Run 2:\n#### With `with-current-buffer`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-current-buffer                               25          0.3539380000  0.0141575200\norg-mode                                                 25          0.0802119999  0.0032084799\norg-fold-initialize                                      25          0.044382      0.00177528\norg-fold-core-initialize                                 25          0.0442840000  0.0017713600\norg-fold-core-add-folding-spec                           125         0.0435089999  0.0003480719\norg-roam-db-autosync--setup-file-h                       25          0.0406990000  0.0016279600\norg-roam-file-p                                          25          0.040631      0.00162524\norg-fold-core--property-symbol-get-create                1200        0.0404260000  3.368...e-05\norg-roam-descendant-of-p                                 25          0.039682      0.0015872800\norg-element-cache-reset                                  25          0.00642       0.0002568\norg-persist-register                                     50          0.005617      0.00011234\norg-macro-initialize-templates                           25          0.0054350000  0.0002174000\norg-persist--get-collection                              75          0.0052669999  7.022...e-05\norg-persist--normalize-associated                        100         0.0042980000  4.298...e-05\norg-set-regexps-and-options                              25          0.002329      9.316e-05\norg-fold-core-set-folding-spec-property                  1275        0.0017129999  1.343...e-06\norg-install-agenda-files-menu                            25          0.0015840000  6.336e-05\norg-collect-keywords                                     50          0.0014700000  2.940...e-05\norg--collect-keywords-1                                  50          0.001206      2.412e-05\norg-macro--collect-macros                                25          0.001069      4.276...e-05\norg-fold-core-get-folding-spec-from-alias                2400        0.0009050000  3.770...e-07\norg-make-options-regexp                                  50          0.0008660000  1.732...e-05\norg-cycle-set-startup-visibility                         25          0.000733      2.932e-05\norg-fold-show-all--text-properties                       25          0.0006640000  2.656...e-05\norg-set-font-lock-defaults                               25          0.000519      2.076e-05\norg-fold-core-region                                     75          0.0005090000  6.786...e-06\norg-element--cache-setup-change-functions                25          0.000457      1.828e-05\norg-persist--find-index                                  75          0.0004219999  5.626...e-06\norg-macro--find-keyword-value                            100         0.0003710000  3.710...e-06\norg--set-faces-extend                                    50          0.0002789999  5.579...e-06\norg-macro--find-date                                     25          0.0002430000  9.720...e-06\norg-cite-try-load-processor                              25          0.0002420000  9.68e-06\norg-persist--normalize-container                         250         0.0002409999  9.639...e-07\norg-setup-filling                                        25          0.0002060000  8.24e-06\norg-babel-hide-all-hashes                                25          0.0001920000  7.680...e-06\norg-cite-get-processor                                   25          0.0001720000  6.880...e-06\norg-persist-load                                         25          0.000167      6.679...e-06\norg-find-invisible-foreground                            25          0.000153      6.12e-06\norg-update-radio-target-regexp                           25          0.000135      5.4e-06\norg-persist-read                                         25          0.0001070000  4.280...e-06\norg-roam--file-name-extension                            25          8.700...e-05  3.480...e-06\norg-assign-fast-keys                                     25          8.2e-05       3.28e-06\norg-extract-log-state-settings                           50          7.699...e-05  1.539...e-06\norg-setup-comments-handling                              25          5.600...e-05  2.240...e-06\norg-fold-core--isearch-setup                             25          4.800...e-05  1.920...e-06\norg-macro--counter-initialize                            25          4.3e-05       1.72e-06\norg-compute-latex-and-related-regexp                     25          4.100...e-05  1.640...e-06\norg-macro--set-templates                                 25          4e-05         1.600...e-06\norg-agenda-files                                         25          3.300...e-05  1.320...e-06\norg-element-restriction                                  25          2.900...e-05  1.160...e-06\norg-load-modules-maybe                                   25          2.700...e-05  1.080...e-06\norg-delete-all                                           25          2.500...e-05  1.000...e-06\norg-element-parse-secondary-string                       25          1.900...e-05  7.600...e-07\norg-babel-result-hide-spec                               25          1.600...e-05  6.400...e-07\norg--tag-add-to-alist                                    25          1.300...e-05  5.200...e-07\norg-tag-alist-to-groups                                  25          1.200...e-05  4.800...e-07\n```\n\n#### with `org-roam-with-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-org-roam-with-file                                25          0.299792      0.01199168\norg-mode                                                 25          0.0647949999  0.0025917999\norg-fold-initialize                                      25          0.0450550000  0.0018022000\norg-fold-core-initialize                                 25          0.0449510000  0.0017980400\norg-fold-core-add-folding-spec                           125         0.0443579999  0.0003548639\norg-element-cache-reset                                  25          0.006359      0.00025436\norg-fold-core--property-symbol-get-create                1125        0.0061050000  5.426...e-06\norg-persist-register                                     50          0.005664      0.00011328\norg-macro-initialize-templates                           25          0.005647      0.00022588\norg-persist--get-collection                              75          0.0053229999  7.097...e-05\norg-persist--normalize-associated                        100         0.0043520000  4.352...e-05\norg-set-regexps-and-options                              25          0.002292      9.168e-05\norg-fold-core-set-folding-spec-property                  1275        0.0017909999  1.404...e-06\norg-install-agenda-files-menu                            25          0.0015469999  6.187...e-05\norg-collect-keywords                                     50          0.0014850000  2.970...e-05\norg--collect-keywords-1                                  50          0.00122       2.44e-05\norg-macro--collect-macros                                25          0.0011669999  4.667...e-05\norg-make-options-regexp                                  50          0.0008790000  1.758...e-05\norg-fold-core-get-folding-spec-from-alias                2250        0.0008740000  3.884...e-07\norg-set-font-lock-defaults                               25          0.0004860000  1.944...e-05\norg-persist--find-index                                  75          0.0004259999  5.679...e-06\norg-macro--find-keyword-value                            100         0.0004060000  4.060...e-06\norg-element--cache-setup-change-functions                25          0.0003270000  1.308...e-05\norg-macro--find-date                                     25          0.0002650000  1.060...e-05\norg--set-faces-extend                                    50          0.000264      5.28e-06\norg-persist--normalize-container                         250         0.0002429999  9.719...e-07\norg-cite-try-load-processor                              25          0.0002250000  9.000...e-06\norg-setup-filling                                        25          0.0001910000  7.640...e-06\norg-persist-load                                         25          0.0001780000  7.120...e-06\norg-cite-get-processor                                   25          0.0001670000  6.680...e-06\norg-find-invisible-foreground                            25          0.0001640000  6.560...e-06\norg-update-radio-target-regexp                           25          0.0001370000  5.480...e-06\norg-persist-read                                         25          0.0001130000  4.520...e-06\norg-assign-fast-keys                                     25          8.200...e-05  3.280...e-06\norg-extract-log-state-settings                           50          7.499...e-05  1.499...e-06\norg-setup-comments-handling                              25          5.8e-05       2.32e-06\norg-roam-with-file                                       25          5.2e-05       2.08e-06\norg-fold-core--isearch-setup                             25          4.8e-05       1.920...e-06\norg-macro--set-templates                                 25          4.500...e-05  1.800...e-06\norg-macro--counter-initialize                            25          4.3e-05       1.72e-06\norg-compute-latex-and-related-regexp                     25          3.9e-05       1.559...e-06\norg-agenda-files                                         25          3.5e-05       1.4e-06\norg-load-modules-maybe                                   25          3.3e-05       1.32e-06\norg-element-restriction                                  25          3.100...e-05  1.240...e-06\norg-delete-all                                           25          2.900...e-05  1.160...e-06\norg-element-parse-secondary-string                       25          2.400...e-05  9.600...e-07\norg-tag-alist-to-groups                                  25          1.400...e-05  5.600...e-07\norg--tag-add-to-alist                                    25          1.100...e-05  4.400...e-07\n```\n\n#### With `with-plain-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-plain-file                                   25          0.2317820000  0.0092712800\n```\n\n### Run 3\n#### With `with-current-buffer`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-current-buffer                               25          0.3760549999  0.0150421999\norg-mode                                                 25          0.1223050000  0.0048922\norg-fold-initialize                                      25          0.0464850000  0.0018594000\norg-fold-core-initialize                                 25          0.046367      0.00185468\norg-fold-core-add-folding-spec                           125         0.0455039999  0.0003640319\norg-roam-db-autosync--setup-file-h                       25          0.0427370000  0.0017094800\norg-roam-file-p                                          25          0.0426590000  0.0017063600\norg-macro-initialize-templates                           25          0.0422699999  0.0016907999\norg-roam-descendant-of-p                                 25          0.0416490000  0.0016659600\norg-fold-core-set-folding-spec-property                  1275        0.037526      2.943...e-05\norg-macro--collect-macros                                25          0.036222      0.0014488799\norg-element-cache-reset                                  25          0.0070009999  0.0002800399\norg-fold-core--property-symbol-get-create                1200        0.0065220000  5.435...e-06\norg-persist-register                                     50          0.0060450000  0.0001209000\norg-persist--get-collection                              75          0.0056679999  7.557...e-05\norg-persist--normalize-associated                        100         0.0046470000  4.647...e-05\norg-set-regexps-and-options                              25          0.002571      0.00010284\norg-collect-keywords                                     50          0.002029      4.058e-05\norg-install-agenda-files-menu                            25          0.0017680000  7.072...e-05\norg--collect-keywords-1                                  50          0.0017289999  3.457...e-05\norg-make-options-regexp                                  50          0.0013410000  2.682...e-05\norg-fold-core-get-folding-spec-from-alias                2400        0.0009450000  3.937...e-07\norg-cycle-set-startup-visibility                         25          0.0008100000  3.24e-05\norg-fold-show-all--text-properties                       25          0.0007339999  2.935...e-05\norg-element--cache-setup-change-functions                25          0.000588      2.352e-05\norg-fold-core-region                                     75          0.0005740000  7.653...e-06\norg-set-font-lock-defaults                               25          0.0005720000  2.288...e-05\norg-persist--find-index                                  75          0.000431      5.746...e-06\norg-macro--find-keyword-value                            100         0.0004100000  4.100...e-06\norg--set-faces-extend                                    50          0.0002759999  5.519...e-06\norg-macro--find-date                                     25          0.0002710000  1.084...e-05\norg-persist--normalize-container                         250         0.0002639999  1.055...e-06\norg-cite-try-load-processor                              25          0.000254      1.016e-05\norg-setup-filling                                        25          0.0002430000  9.720...e-06\norg-babel-hide-all-hashes                                25          0.0002100000  8.400...e-06\norg-cite-get-processor                                   25          0.0001840000  7.360...e-06\norg-persist-load                                         25          0.0001760000  7.040...e-06\norg-find-invisible-foreground                            25          0.0001680000  6.720...e-06\norg-update-radio-target-regexp                           25          0.000152      6.08e-06\norg-persist-read                                         25          0.0001150000  4.600...e-06\norg-roam--file-name-extension                            25          9.700...e-05  3.880...e-06\norg-extract-log-state-settings                           50          9.299...e-05  1.859...e-06\norg-assign-fast-keys                                     25          8.600...e-05  3.440...e-06\norg-setup-comments-handling                              25          6.000...e-05  2.400...e-06\norg-macro--counter-initialize                            25          5.300...e-05  2.120...e-06\norg-fold-core--isearch-setup                             25          4.900...e-05  1.960...e-06\norg-compute-latex-and-related-regexp                     25          4.5e-05       1.800...e-06\norg-macro--set-templates                                 25          4.400...e-05  1.760...e-06\norg-element-restriction                                  25          3.6e-05       1.44e-06\norg-agenda-files                                         25          3.599...e-05  1.439...e-06\norg-load-modules-maybe                                   25          3.000...e-05  1.200...e-06\norg-delete-all                                           25          2.900...e-05  1.160...e-06\norg-tag-alist-to-groups                                  25          2.100...e-05  8.400...e-07\norg-babel-result-hide-spec                               25          2.000...e-05  8.000...e-07\norg-element-parse-secondary-string                       25          1.900...e-05  7.600...e-07\norg--tag-add-to-alist                                    25          1e-05         4.000...e-07\n```\n\n#### with `org-roam-with-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-org-roam-with-file                                25          0.3454239999  0.0138169599\norg-mode                                                 25          0.1183370000  0.0047334800\norg-set-regexps-and-options                              25          0.0498989999  0.0019959599\norg-collect-keywords                                     50          0.0488559999  0.0009771199\norg-fold-initialize                                      25          0.047466      0.00189864\norg-fold-core-initialize                                 25          0.047341      0.00189364\norg-fold-core-add-folding-spec                           125         0.0465069999  0.0003720559\norg-fold-core--property-symbol-get-create                1125        0.0426880000  3.794...e-05\norg-element-cache-reset                                  25          0.0076450000  0.0003058000\norg-persist-register                                     50          0.0066970000  0.0001339400\norg-macro-initialize-templates                           25          0.0064580000  0.0002583200\norg-persist--get-collection                              75          0.0062649999  8.353...e-05\norg-persist--normalize-associated                        100         0.0051300000  5.130...e-05\norg-fold-core-set-folding-spec-property                  1275        0.0021109999  1.655...e-06\norg-install-agenda-files-menu                            25          0.0019630000  7.852...e-05\norg--collect-keywords-1                                  50          0.0015359999  3.072e-05\norg-macro--collect-macros                                25          0.001305      5.219...e-05\norg-make-options-regexp                                  50          0.001092      2.184e-05\norg-fold-core-get-folding-spec-from-alias                2250        0.0010640000  4.728...e-07\norg-set-font-lock-defaults                               25          0.000631      2.524...e-05\norg-element--cache-setup-change-functions                25          0.000541      2.164...e-05\norg-persist--find-index                                  75          0.0004830000  6.440...e-06\norg-macro--find-keyword-value                            100         0.0004490000  4.490...e-06\norg--set-faces-extend                                    50          0.0003039999  6.079...e-06\norg-macro--find-date                                     25          0.0003020000  1.208...e-05\norg-setup-filling                                        25          0.0002960000  1.184...e-05\norg-cite-try-load-processor                              25          0.0002909999  1.163...e-05\norg-persist--normalize-container                         250         0.0002659999  1.063...e-06\norg-cite-get-processor                                   25          0.0002160000  8.640...e-06\norg-persist-load                                         25          0.0001980000  7.920...e-06\norg-find-invisible-foreground                            25          0.0001830000  7.320...e-06\norg-update-radio-target-regexp                           25          0.0001600000  6.400...e-06\norg-persist-read                                         25          0.0001290000  5.160...e-06\norg-assign-fast-keys                                     25          9.400...e-05  3.760...e-06\norg-extract-log-state-settings                           50          8.799...e-05  1.759...e-06\norg-setup-comments-handling                              25          7.2e-05       2.88e-06\norg-fold-core--isearch-setup                             25          5.800...e-05  2.320...e-06\norg-macro--counter-initialize                            25          5.600...e-05  2.24e-06\norg-roam-with-file                                       25          5.300...e-05  2.120...e-06\norg-compute-latex-and-related-regexp                     25          4.8e-05       1.920...e-06\norg-macro--set-templates                                 25          4.5e-05       1.800...e-06\norg-agenda-files                                         25          4.4e-05       1.759...e-06\norg-element-restriction                                  25          3.600...e-05  1.440...e-06\norg-load-modules-maybe                                   25          3.599...e-05  1.439...e-06\norg-delete-all                                           25          3.100...e-05  1.240...e-06\norg-element-parse-secondary-string                       25          2.600...e-05  1.040...e-06\norg-tag-alist-to-groups                                  25          1.900...e-05  7.600...e-07\norg--tag-add-to-alist                                    25          1.800...e-05  7.200...e-07\n```\n\n#### With `with-plain-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-plain-file                                   25          0.2099760000  0.0083990400\n```\n\n\n## Test with org version `9.5.5-g8cc821` in `emacs -Q`\nThe same test with `emacs -Q` with org version:\n```sh\nOrg mode version 9.5.5 (9.5.5-g8cc821 @ ~/.emacs.d/straight/build/org/)\n```\n\n### Run 1\n#### With `with-current-buffer`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-current-buffer                               25          0.3468619999  0.0138744799\norg-mode                                                 25          0.109437      0.00437748\norg-fold-initialize                                      25          0.042489      0.00169956\norg-fold-core-initialize                                 25          0.0423939999  0.0016957599\norg-fold-core-add-folding-spec                           125         0.0417029999  0.0003336239\norg-roam-db-autosync--setup-file-h                       25          0.0403400000  0.0016136000\norg-roam-file-p                                          25          0.0402700000  0.0016108000\norg-roam-descendant-of-p                                 25          0.0393190000  0.0015727600\norg-set-regexps-and-options                              25          0.0339719999  0.0013588799\norg-collect-keywords                                     50          0.0331579999  0.0006631599\norg--collect-keywords-1                                  50          0.0328970000  0.0006579400\norg-make-options-regexp                                  50          0.0325419999  0.0006508399\norg-element-cache-reset                                  25          0.0062250000  0.0002490000\norg-fold-core--property-symbol-get-create                1200        0.0058510000  4.875...e-06\norg-persist-register                                     50          0.0054980000  0.0001099600\norg-macro-initialize-templates                           25          0.0054269999  0.0002170799\norg-persist--get-collection                              75          0.0051739999  6.898...e-05\norg-persist--normalize-associated                        100         0.0042200000  4.220...e-05\norg-fold-core-set-folding-spec-property                  1150        0.0016499999  1.434...e-06\norg-install-agenda-files-menu                            25          0.001484      5.936e-05\norg-macro--collect-macros                                25          0.001083      4.332e-05\norg-fold-core-get-folding-spec-from-alias                2400        0.0009030000  3.762...e-07\norg-cycle-set-startup-visibility                         25          0.0007920000  3.168e-05\norg-fold-show-all                                        25          0.0007310000  2.924...e-05\norg-fold-region                                          75          0.0006160000  8.213...e-06\norg-fold-core-region                                     75          0.0004960000  6.613...e-06\norg-set-font-lock-defaults                               25          0.000479      1.916e-05\norg-macro--find-keyword-value                            100         0.0004160000  4.160...e-06\norg-persist--find-index                                  75          0.0004099999  5.466...e-06\norg-element--cache-setup-change-functions                25          0.0003930000  1.572...e-05\norg-macro--find-date                                     25          0.0002310000  9.240...e-06\norg--set-faces-extend                                    50          0.000231      4.62e-06\norg-persist--normalize-container                         250         0.0002249999  8.999...e-07\norg-setup-filling                                        25          0.0002200000  8.800...e-06\norg-cite-try-load-processor                              25          0.0002130000  8.520...e-06\norg-babel-hide-all-hashes                                25          0.0001960000  7.840...e-06\norg-cite-get-processor                                   25          0.0001610000  6.440...e-06\norg-persist-load                                         25          0.000151      6.040...e-06\norg-find-invisible-foreground                            25          0.0001420000  5.680...e-06\norg-update-radio-target-regexp                           25          0.000125      5e-06\norg-persist-read                                         25          0.0001060000  4.240...e-06\norg-roam--file-name-extension                            25          8.400...e-05  3.360...e-06\norg-assign-fast-keys                                     25          7.6e-05       3.04e-06\norg-extract-log-state-settings                           50          7.399...e-05  1.479...e-06\norg-setup-comments-handling                              25          5.299...e-05  2.119...e-06\norg-macro--counter-initialize                            25          4.200...e-05  1.680...e-06\norg-fold-core--isearch-setup                             25          4.199...e-05  1.679...e-06\norg-macro--set-templates                                 25          3.700...e-05  1.480...e-06\norg-compute-latex-and-related-regexp                     25          3.7e-05       1.48e-06\norg-agenda-files                                         25          3.000...e-05  1.200...e-06\norg-element-restriction                                  25          3.000...e-05  1.200...e-06\norg-delete-all                                           25          2.600...e-05  1.040...e-06\norg-load-modules-maybe                                   25          2.5e-05       1e-06\norg-babel-result-hide-spec                               25          2.000...e-05  8.000...e-07\norg-element-parse-secondary-string                       25          1.700...e-05  6.800...e-07\norg-tag-alist-to-groups                                  25          1.400...e-05  5.600...e-07\norg--tag-add-to-alist                                    25          9e-06         3.6e-07\n\n```\n\n#### with `org-roam-with-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-org-roam-with-file                                25          0.3024920000  0.0120996800\norg-mode                                                 25          0.0967239999  0.0038689599\norg-set-regexps-and-options                              25          0.0352130000  0.0014085200\norg-set-font-lock-defaults                               25          0.0344420000  0.0013776800\norg-fold-initialize                                      25          0.0100299999  0.0004011999\norg-fold-core-initialize                                 25          0.0099269999  0.0003970799\norg-fold-core-add-folding-spec                           125         0.0093699999  7.495...e-05\norg-element-cache-reset                                  25          0.0066259999  0.0002650399\norg-fold-core--property-symbol-get-create                1125        0.0062010000  5.512...e-06\norg-persist-register                                     50          0.0059370000  0.0001187400\norg-macro-initialize-templates                           25          0.0057430000  0.0002297200\norg-persist--get-collection                              75          0.0055909999  7.454...e-05\norg-persist--normalize-associated                        100         0.0045920000  4.592...e-05\norg-fold-core-set-folding-spec-property                  1150        0.0017669999  1.536...e-06\norg-collect-keywords                                     50          0.001493      2.986e-05\norg-install-agenda-files-menu                            25          0.0014390000  5.756...e-05\norg--collect-keywords-1                                  50          0.0012340000  2.468...e-05\norg-macro--collect-macros                                25          0.001156      4.624e-05\norg-fold-core-get-folding-spec-from-alias                2250        0.0009180000  4.080...e-07\norg-make-options-regexp                                  50          0.0008840000  1.768...e-05\norg-macro--find-keyword-value                            100         0.0004440000  4.440...e-06\norg-persist--find-index                                  75          0.000423      5.639...e-06\norg-element--cache-setup-change-functions                25          0.000332      1.328e-05\norg-cite-try-load-processor                              25          0.000253      1.012...e-05\norg-macro--find-date                                     25          0.0002520000  1.008...e-05\norg-persist--normalize-container                         250         0.0002519999  1.007...e-06\norg--set-faces-extend                                    50          0.0002170000  4.340...e-06\norg-setup-filling                                        25          0.0002099999  8.4e-06\norg-cite-get-processor                                   25          0.0001840000  7.360...e-06\norg-persist-load                                         25          0.0001770000  7.080...e-06\norg-find-invisible-foreground                            25          0.0001390000  5.560...e-06\norg-update-radio-target-regexp                           25          0.000132      5.28e-06\norg-persist-read                                         25          0.000128      5.12e-06\norg-extract-log-state-settings                           50          8.799...e-05  1.759...e-06\norg-assign-fast-keys                                     25          8e-05         3.200...e-06\norg-fold-core--isearch-setup                             25          5.400...e-05  2.160...e-06\norg-setup-comments-handling                              25          5.3e-05       2.12e-06\norg-roam-with-file                                       25          4.3e-05       1.72e-06\norg-macro--set-templates                                 25          4.200...e-05  1.680...e-06\norg-macro--counter-initialize                            25          4.1e-05       1.64e-06\norg-compute-latex-and-related-regexp                     25          3.6e-05       1.44e-06\norg-element-restriction                                  25          3.200...e-05  1.280...e-06\norg-agenda-files                                         25          3.100...e-05  1.240...e-06\norg-delete-all                                           25          2.300...e-05  9.200...e-07\norg-load-modules-maybe                                   25          2.100...e-05  8.400...e-07\norg-element-parse-secondary-string                       25          1.900...e-05  7.600...e-07\norg--tag-add-to-alist                                    25          1.500...e-05  6.000...e-07\norg-tag-alist-to-groups                                  25          1.300...e-05  5.200...e-07\n```\n\n#### With `with-plain-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-plain-file                                   25          0.190576      0.00762304\n```\n\n### Run 2\n#### With `with-current-buffer`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-current-buffer                               25          0.3675650000  0.0147026000\norg-roam-db-autosync--setup-file-h                       25          0.0761019999  0.0030440799\norg-roam-file-p                                          25          0.0760250000  0.0030410000\norg-mode                                                 25          0.0478        0.001912\norg-roam-descendant-of-p                                 25          0.0418020000  0.0016720800\norg-roam--file-name-extension                            25          0.033206      0.00132824\norg-fold-initialize                                      25          0.0102250000  0.0004090000\norg-fold-core-initialize                                 25          0.0101079999  0.0004043199\norg-fold-core-add-folding-spec                           125         0.0092419999  7.393...e-05\norg-element-cache-reset                                  25          0.006654      0.00026616\norg-fold-core--property-symbol-get-create                1200        0.0062640000  5.220...e-06\norg-persist-register                                     50          0.005767      0.00011534\norg-macro-initialize-templates                           25          0.0057529999  0.0002301199\norg-persist--get-collection                              75          0.0053749999  7.166...e-05\norg-persist--normalize-associated                        100         0.0043510000  4.351...e-05\norg-set-regexps-and-options                              25          0.0025109999  0.00010044\norg-install-agenda-files-menu                            25          0.0017969999  7.187...e-05\norg-fold-core-set-folding-spec-property                  1150        0.0017119999  1.488...e-06\norg-collect-keywords                                     50          0.001584      3.167...e-05\norg--collect-keywords-1                                  50          0.001289      2.578e-05\norg-macro--collect-macros                                25          0.0011589999  4.635...e-05\norg-fold-core-get-folding-spec-from-alias                2400        0.0009350000  3.895...e-07\norg-make-options-regexp                                  50          0.0009330000  1.866...e-05\norg-cycle-set-startup-visibility                         25          0.000837      3.348e-05\norg-fold-show-all                                        25          0.000764      3.056e-05\norg-fold-region                                          75          0.000628      8.373...e-06\norg-set-font-lock-defaults                               25          0.0005530000  2.212...e-05\norg-fold-core-region                                     75          0.0005140000  6.853...e-06\norg-element--cache-setup-change-functions                25          0.0005120000  2.048...e-05\norg-persist--find-index                                  75          0.0004490000  5.986...e-06\norg-macro--find-keyword-value                            100         0.0003950000  3.950...e-06\norg--set-faces-extend                                    50          0.0002870000  5.740...e-06\norg-macro--find-date                                     25          0.000271      1.084e-05\norg-persist--normalize-container                         250         0.0002529999  1.011...e-06\norg-cite-try-load-processor                              25          0.00025       1e-05\norg-setup-filling                                        25          0.0002120000  8.480...e-06\norg-babel-hide-all-hashes                                25          0.0002000000  8.000...e-06\norg-persist-load                                         25          0.0001800000  7.200...e-06\norg-cite-get-processor                                   25          0.0001770000  7.080...e-06\norg-find-invisible-foreground                            25          0.00017       6.8e-06\norg-update-radio-target-regexp                           25          0.0001390000  5.560...e-06\norg-persist-read                                         25          0.0001170000  4.68e-06\norg-assign-fast-keys                                     25          8.800...e-05  3.520...e-06\norg-extract-log-state-settings                           50          7.699...e-05  1.539...e-06\norg-fold-core--isearch-setup                             25          6.300...e-05  2.520...e-06\norg-setup-comments-handling                              25          5.500...e-05  2.200...e-06\norg-macro--counter-initialize                            25          4.900...e-05  1.960...e-06\norg-macro--set-templates                                 25          4.000...e-05  1.600...e-06\norg-agenda-files                                         25          3.599...e-05  1.439...e-06\norg-compute-latex-and-related-regexp                     25          3.500...e-05  1.400...e-06\norg-load-modules-maybe                                   25          3.4e-05       1.36e-06\norg-element-restriction                                  25          3.4e-05       1.36e-06\norg-delete-all                                           25          2.900...e-05  1.160...e-06\norg-element-parse-secondary-string                       25          2.200...e-05  8.800...e-07\norg-babel-result-hide-spec                               25          2.000...e-05  8.000...e-07\norg-tag-alist-to-groups                                  25          2.000...e-05  8.000...e-07\norg--tag-add-to-alist                                    25          1.800...e-05  7.200...e-07\n```\n\n#### with `org-roam-with-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-org-roam-with-file                                25          0.297846      0.01191384\norg-mode                                                 25          0.0663639999  0.00265456\norg-macro-initialize-templates                           25          0.0414050000  0.0016562000\norg-macro--counter-initialize                            25          0.03567       0.0014268\norg-fold-initialize                                      25          0.0099350000  0.0003974000\norg-fold-core-initialize                                 25          0.009818      0.00039272\norg-fold-core-add-folding-spec                           125         0.0091620000  7.329...e-05\norg-element-cache-reset                                  25          0.006497      0.00025988\norg-fold-core--property-symbol-get-create                1125        0.0060750000  5.400...e-06\norg-persist-register                                     50          0.0057070000  0.0001141400\norg-persist--get-collection                              75          0.0053299999  7.106...e-05\norg-persist--normalize-associated                        100         0.0043460000  4.346...e-05\norg-set-regexps-and-options                              25          0.002475      9.900...e-05\norg-install-agenda-files-menu                            25          0.0017709999  7.083...e-05\norg-fold-core-set-folding-spec-property                  1150        0.0017329999  1.506...e-06\norg-collect-keywords                                     50          0.001583      3.166e-05\norg--collect-keywords-1                                  50          0.0012859999  2.571...e-05\norg-macro--collect-macros                                25          0.001171      4.684e-05\norg-make-options-regexp                                  50          0.0009220000  1.844...e-05\norg-fold-core-get-folding-spec-from-alias                2250        0.0008730000  3.880...e-07\norg-set-font-lock-defaults                               25          0.0005250000  2.100...e-05\norg-persist--find-index                                  75          0.000432      5.76e-06\norg-element--cache-setup-change-functions                25          0.0004260000  1.704...e-05\norg-macro--find-keyword-value                            100         0.0003990000  3.990...e-06\norg--set-faces-extend                                    50          0.0002879999  5.759...e-06\norg-macro--find-date                                     25          0.000267      1.068e-05\norg-setup-filling                                        25          0.0002500000  1.000...e-05\norg-persist--normalize-container                         250         0.0002469999  9.879...e-07\norg-cite-try-load-processor                              25          0.0002300000  9.200...e-06\norg-find-invisible-foreground                            25          0.0001780000  7.120...e-06\norg-cite-get-processor                                   25          0.0001760000  7.040...e-06\norg-persist-load                                         25          0.000171      6.840...e-06\norg-update-radio-target-regexp                           25          0.000143      5.72e-06\norg-persist-read                                         25          0.0001130000  4.520...e-06\norg-assign-fast-keys                                     25          8.600...e-05  3.440...e-06\norg-extract-log-state-settings                           50          7.599...e-05  1.519...e-06\norg-setup-comments-handling                              25          6.100...e-05  2.440...e-06\norg-fold-core--isearch-setup                             25          5.700...e-05  2.28e-06\norg-roam-with-file                                       25          5.400...e-05  2.160...e-06\norg-macro--set-templates                                 25          4.300...e-05  1.720...e-06\norg-agenda-files                                         25          4.100...e-05  1.640...e-06\norg-compute-latex-and-related-regexp                     25          4.000...e-05  1.600...e-06\norg-element-restriction                                  25          3.500...e-05  1.400...e-06\norg-load-modules-maybe                                   25          3.200...e-05  1.280...e-06\norg-delete-all                                           25          3.100...e-05  1.240...e-06\norg-element-parse-secondary-string                       25          2.300...e-05  9.200...e-07\norg-tag-alist-to-groups                                  25          1.900...e-05  7.600...e-07\norg--tag-add-to-alist                                    25          1.200...e-05  4.800...e-07\n```\n\n#### With `with-plain-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-plain-file                                   25          0.214249      0.00856996\n```\n\n### Run 3\n#### With `with-current-buffer`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-current-buffer                               25          0.358344      0.01433376\norg-roam-db-autosync--setup-file-h                       25          0.0754349999  0.0030173999\norg-roam-file-p                                          25          0.075358      0.0030143199\norg-roam-descendant-of-p                                 25          0.0742949999  0.0029717999\norg-mode                                                 25          0.0468290000  0.0018731600\norg-fold-initialize                                      25          0.0098470000  0.0003938800\norg-fold-core-initialize                                 25          0.0097399999  0.0003895999\norg-fold-core-add-folding-spec                           125         0.008941      7.1528e-05\norg-element-cache-reset                                  25          0.0064449999  0.0002578\norg-fold-core--property-symbol-get-create                1200        0.0060140000  5.011...e-06\norg-persist-register                                     50          0.0056399999  0.0001127999\norg-macro-initialize-templates                           25          0.00553       0.0002212\norg-persist--get-collection                              75          0.0052869999  7.049...e-05\norg-persist--normalize-associated                        100         0.0043050000  4.305...e-05\norg-set-regexps-and-options                              25          0.0023629999  9.451...e-05\norg-install-agenda-files-menu                            25          0.0017250000  6.900...e-05\norg-fold-core-set-folding-spec-property                  1150        0.0016719999  1.453...e-06\norg-collect-keywords                                     50          0.0014929999  2.985...e-05\norg--collect-keywords-1                                  50          0.0012090000  2.418...e-05\norg-macro--collect-macros                                25          0.001072      4.288e-05\norg-fold-core-get-folding-spec-from-alias                2400        0.0008980000  3.741...e-07\norg-make-options-regexp                                  50          0.0008630000  1.726...e-05\norg-cycle-set-startup-visibility                         25          0.0008450000  3.380...e-05\norg-fold-show-all                                        25          0.0007689999  3.075...e-05\norg-fold-region                                          75          0.0006370000  8.493...e-06\norg-set-font-lock-defaults                               25          0.0005360000  2.144...e-05\norg-fold-core-region                                     75          0.0005210000  6.946...e-06\norg-element--cache-setup-change-functions                25          0.0004589999  1.835...e-05\norg-persist--find-index                                  75          0.0004320000  5.760...e-06\norg-macro--find-keyword-value                            100         0.0003720000  3.720...e-06\norg--set-faces-extend                                    50          0.0002739999  5.479...e-06\norg-persist--normalize-container                         250         0.0002549999  1.019...e-06\norg-cite-try-load-processor                              25          0.000252      1.008e-05\norg-macro--find-date                                     25          0.0002400000  9.600...e-06\norg-setup-filling                                        25          0.0002030000  8.120...e-06\norg-babel-hide-all-hashes                                25          0.0001970000  7.880...e-06\norg-cite-get-processor                                   25          0.0001860000  7.440...e-06\norg-find-invisible-foreground                            25          0.0001790000  7.160...e-06\norg-persist-load                                         25          0.0001760000  7.040...e-06\norg-update-radio-target-regexp                           25          0.0001390000  5.560...e-06\norg-persist-read                                         25          0.0001080000  4.320...e-06\norg-roam--file-name-extension                            25          8.300...e-05  3.320...e-06\norg-extract-log-state-settings                           50          8.299...e-05  1.659...e-06\norg-assign-fast-keys                                     25          8.200...e-05  3.280...e-06\norg-setup-comments-handling                              25          5.700...e-05  2.28e-06\norg-fold-core--isearch-setup                             25          5.600...e-05  2.240...e-06\norg-macro--set-templates                                 25          4.600...e-05  1.840...e-06\norg-macro--counter-initialize                            25          4.5e-05       1.800...e-06\norg-compute-latex-and-related-regexp                     25          3.899...e-05  1.559...e-06\norg-element-restriction                                  25          3.800...e-05  1.520...e-06\norg-agenda-files                                         25          3.7e-05       1.48e-06\norg-load-modules-maybe                                   25          3.000...e-05  1.200...e-06\norg-delete-all                                           25          2.900...e-05  1.160...e-06\norg-babel-result-hide-spec                               25          2.400...e-05  9.600...e-07\norg-element-parse-secondary-string                       25          2.400...e-05  9.600...e-07\norg--tag-add-to-alist                                    25          1.900...e-05  7.600...e-07\norg-tag-alist-to-groups                                  25          1.600...e-05  6.400...e-07\n```\n\n#### with `org-roam-with-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-org-roam-with-file                                25          0.3011910000  0.0120476400\norg-mode                                                 25          0.065139      0.0026055600\norg-macro-initialize-templates                           25          0.0411049999  0.0016441999\norg-collect-keywords                                     50          0.036973      0.0007394599\norg--collect-keywords-1                                  50          0.0366959999  0.0007339199\norg-macro--collect-macros                                25          0.036578      0.00146312\norg-make-options-regexp                                  50          0.036341      0.00072682\norg-fold-initialize                                      25          0.0099750000  0.0003990000\norg-fold-core-initialize                                 25          0.0098709999  0.0003948399\norg-fold-core-add-folding-spec                           125         0.0092929999  7.434...e-05\norg-element-cache-reset                                  25          0.006196      0.00024784\norg-fold-core--property-symbol-get-create                1125        0.0061050000  5.426...e-06\norg-persist-register                                     50          0.0055499999  0.0001109999\norg-persist--get-collection                              75          0.0052079999  6.943...e-05\norg-persist--normalize-associated                        100         0.0042200000  4.220...e-05\norg-set-regexps-and-options                              25          0.0023600000  9.440...e-05\norg-fold-core-set-folding-spec-property                  1150        0.0017279999  1.502...e-06\norg-install-agenda-files-menu                            25          0.00158       6.32e-05\norg-fold-core-get-folding-spec-from-alias                2250        0.0008660000  3.848...e-07\norg-set-font-lock-defaults                               25          0.0005090000  2.036...e-05\norg-persist--find-index                                  75          0.0004350000  5.8e-06\norg-macro--find-keyword-value                            100         0.0003630000  3.630...e-06\norg-element--cache-setup-change-functions                25          0.0003070000  1.228...e-05\norg-macro--find-date                                     25          0.000266      1.064e-05\norg--set-faces-extend                                    50          0.000264      5.28e-06\norg-persist--normalize-container                         250         0.0002469999  9.879...e-07\norg-cite-try-load-processor                              25          0.000228      9.12e-06\norg-setup-filling                                        25          0.0001930000  7.72e-06\norg-persist-load                                         25          0.0001780000  7.120...e-06\norg-cite-get-processor                                   25          0.0001640000  6.560...e-06\norg-find-invisible-foreground                            25          0.0001610000  6.440...e-06\norg-update-radio-target-regexp                           25          0.00014       5.6e-06\norg-persist-read                                         25          0.0001130000  4.520...e-06\norg-assign-fast-keys                                     25          8.1e-05       3.240...e-06\norg-extract-log-state-settings                           50          7.199...e-05  1.439...e-06\norg-setup-comments-handling                              25          6.1e-05       2.44e-06\norg-fold-core--isearch-setup                             25          5.200...e-05  2.080...e-06\norg-roam-with-file                                       25          4.700...e-05  1.880...e-06\norg-compute-latex-and-related-regexp                     25          4.499...e-05  1.8e-06\norg-macro--set-templates                                 25          4.400...e-05  1.760...e-06\norg-macro--counter-initialize                            25          4.100...e-05  1.640...e-06\norg-element-restriction                                  25          3.400...e-05  1.360...e-06\norg-agenda-files                                         25          3.200...e-05  1.280...e-06\norg-element-parse-secondary-string                       25          2.800...e-05  1.120...e-06\norg-load-modules-maybe                                   25          2.600...e-05  1.040...e-06\norg-delete-all                                           25          2.300...e-05  9.200...e-07\norg--tag-add-to-alist                                    25          1.900...e-05  7.600...e-07\norg-tag-alist-to-groups                                  25          1.500...e-05  6.000...e-07\n```\n\n#### With `with-plain-file`\n```csv\n  Function Name                                          Call Count  Elapsed Time  Average Time\n--test-with-plain-file                                   25          0.2157019999  0.00862808\n```\n\n\n## Summery from the `emacs -Q` profiles\n\u003ctable class=\"table-auto\"\u003e\n \u003ccolgroup\u003e\u003ccol\u003e\n \u003ccol\u003e\n \u003c/colgroup\u003e\u003ctbody\u003e\u003ctr\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" rowspan=\"2\"\u003eFunctions\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600\" colspan=\"4\"\u003eOrg version 9.5.5-g8cc821\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600\" colspan=\"4\"\u003eOrg version 9.5.4-g5a6442\u003c/td\u003e\n \u003c/tr\u003e\n \u003ctr\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003eRun1\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003eRun2\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003eRun3\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003eAvg\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003eRun1\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003eRun2\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003eRun3\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003eAvg\u003c/td\u003e\n \u003c/tr\u003e\n \u003ctr\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003etest-with-current-buffer\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.0141548\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01415752\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.0150422\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.014451507\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01387448\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.0147026\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01433376\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.014303613\u003c/td\u003e\n \u003c/tr\u003e\n \u003ctr\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" height=\"20\" \u003etest-org-roam-with-file\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01293492\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01199168\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01381696\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01291452\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01209968\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01191384\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.01204764\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.012020387\u003c/td\u003e\n \u003c/tr\u003e\n \u003ctr\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" height=\"20\" \u003etest-with-plain-file\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.00915172\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.00927128\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.00839904\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.00894068\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.00762304\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.00856996\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.00862808\u003c/td\u003e\n  \u003ctd class=\"border border-slate-600 p-2\" \u003e0.008273693\u003c/td\u003e\n \u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2022-09-16-profiling_loading_org_files"},"buildId":"FFog9YVRqo4UhYbgP_GpH","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>